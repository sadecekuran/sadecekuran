<!doctype html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1" />
<title>SADECE KURAN</title>
<link rel="icon" type="image/png" href="/logokuran2.jpg"/>
<link rel="apple-touch-icon" href="/logokuran2.jpg">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Scheherazade+New:wght@400;700&display=swap">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
/* Dark Mode (Original) */
--primary-dark: #15202b;
--secondary-dark: #192734;
--accent-dark: #22303c;
--text-dark: #ffffff;
--highlight-dark: #1da1f2;

/* True Black Mode */
--primary-black: #000000;
--secondary-black: #0a0a0a;
--accent-black: #1a1a1a;
--text-black: #e0e0e0;
--highlight-black: #4a9eff;

/* Eye Mode (Muted Colors) */
--primary-eye: #1a1a1a;
--secondary-eye: #2d2d2d;
--accent-eye: #404040;
--text-eye: #d4d4d4;
--highlight-eye: #7ba7d9;

/* Light Mode */
--primary-light: #ffffff;
--secondary-light: #f7f9fa;
--accent-light: #ebeef0;
--text-light: #0f1419;
--highlight-light: #1da1f2;

--transition-speed: 0.3s;
--transition-function: cubic-bezier(0.4, 0, 0.2, 1);
--verse-font-size: 100%;
}

* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
font-family: 'Poppins', sans-serif;
background-color: var(--primary-dark);
color: var(--text-dark);
line-height: 1.5;
display: flex;
flex-direction: column;
min-height: 100vh;
transition: background 0.3s var(--transition-function), color 0.3s var(--transition-function);
scrollbar-width: thin;
scrollbar-color: var(--accent-dark) var(--primary-dark);
overflow-x: hidden;
}

body.day-mode {
background-color: var(--primary-light);
color: var(--text-light);
scrollbar-color: var(--accent-light) var(--primary-light);
}

body.black-mode {
background-color: var(--primary-black);
color: var(--text-black);
scrollbar-color: var(--accent-black) var(--primary-black);
}

body.eye-mode {
background-color: var(--primary-eye);
color: var(--text-eye);
scrollbar-color: var(--accent-eye) var(--primary-eye);
}

body::-webkit-scrollbar {
width: 8px;
}

body::-webkit-scrollbar-track {
background: var(--primary-dark);
}

body.day-mode::-webkit-scrollbar-track {
background: var(--primary-light);
}

body.black-mode::-webkit-scrollbar-track {
background: var(--primary-black);
}

body.eye-mode::-webkit-scrollbar-track {
background: var(--primary-eye);
}

body::-webkit-scrollbar-thumb {
background-color: var(--accent-dark);
border-radius: 20px;
}

body.day-mode::-webkit-scrollbar-thumb {
background-color: var(--accent-light);
}

body.black-mode::-webkit-scrollbar-thumb {
background-color: var(--accent-black);
}

body.eye-mode::-webkit-scrollbar-thumb {
background-color: var(--accent-eye);
}

/* Sidebar - Desktop */
.sidebar {
width: 60px;
background-color: var(--secondary-dark);
display: flex;
flex-direction: column;
align-items: center;
padding: 20px 0;
position: fixed;
height: 100%;
z-index: 10;
transition: background-color 0.3s var(--transition-function);
}

body.day-mode .sidebar {
background-color: var(--secondary-light);
border-right: 1px solid var(--accent-light);
}

body.black-mode .sidebar {
background-color: var(--secondary-black);
border-right: 1px solid var(--accent-black);
}

body.eye-mode .sidebar {
background-color: var(--secondary-eye);
border-right: 1px solid var(--accent-eye);
}

.sidebar-logo {
width: 40px;
height: 40px;
border-radius: 50%;
margin-bottom: 30px;
object-fit: cover;
}

.sidebar-nav {
display: flex;
flex-direction: column;
align-items: center;
width: 100%;
}

.nav-item {
width: 100%;
display: flex;
justify-content: center;
padding: 15px 0;
color: var(--text-dark);
font-size: 1.3rem;
cursor: pointer;
transition: background-color 0.2s var(--transition-function);
position: relative;
}

body.day-mode .nav-item {
color: var(--text-light);
}

body.black-mode .nav-item {
color: var(--text-black);
}

body.eye-mode .nav-item {
color: var(--text-eye);
}

.nav-item:hover {
background-color: var(--accent-dark);
}

body.day-mode .nav-item:hover {
background-color: var(--accent-light);
}

body.black-mode .nav-item:hover {
background-color: var(--accent-black);
}

body.eye-mode .nav-item:hover {
background-color: var(--accent-eye);
}

.nav-item.active {
color: var(--highlight-dark);
}

body.black-mode .nav-item.active {
color: var(--highlight-black);
}

body.eye-mode .nav-item.active {
color: var(--highlight-eye);
}

.nav-item.active::before {
content: '';
position: absolute;
left: 0;
height: 100%;
width: 3px;
background-color: var(--highlight-dark);
}

body.black-mode .nav-item.active::before {
background-color: var(--highlight-black);
}

body.eye-mode .nav-item.active::before {
background-color: var(--highlight-eye);
}

/* Main Content */
.main-content {
flex: 1;
margin-left: 60px;
display: flex;
flex-direction: column;
min-height: 100vh;
}

/* Header */
.header {
padding: 15px 20px;
border-bottom: 1px solid var(--accent-dark);
display: flex;
justify-content: space-between;
align-items: center;
position: sticky;
top: 0;
background-color: var(--primary-dark);
z-index: 5;
transition: background-color 0.3s var(--transition-function);
}

body.day-mode .header {
background-color: var(--primary-light);
border-bottom: 1px solid var(--accent-light);
}

body.black-mode .header {
background-color: var(--primary-black);
border-bottom: 1px solid var(--accent-black);
}

body.eye-mode .header {
background-color: var(--primary-eye);
border-bottom: 1px solid var(--accent-eye);
}

.header h1 {
font-size: 1.2rem;
font-weight: 700;
}

.header-actions {
display: flex;
align-items: center;
gap: 15px;
}

#theme-toggle {
background: none;
border: none;
color: var(--text-dark);
font-size: 1.2rem;
cursor: pointer;
padding: 8px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: background-color 0.2s var(--transition-function);
}

body.day-mode #theme-toggle {
color: var(--text-light);
}

body.black-mode #theme-toggle {
color: var(--text-black);
}

body.eye-mode #theme-toggle {
color: var(--text-eye);
}

#theme-toggle:hover {
background-color: var(--accent-dark);
}

body.day-mode #theme-toggle:hover {
background-color: var(--accent-light);
}

body.black-mode #theme-toggle:hover {
background-color: var(--accent-black);
}

body.eye-mode #theme-toggle:hover {
background-color: var(--accent-eye);
}

/* Content Container */
.content {
flex: 1;
padding: 20px;
max-width: 800px;
margin: 0 auto;
width: 100%;
padding-bottom: 80px;
}

/* BÜYÜK EKRANLAR İÇİN CONTENT GENİŞLETME */
@media (min-width: 1200px) {
.content {
max-width: 1400px;
}
}

/* Controls */
.controls {
margin-bottom: 20px;
display: flex;
flex-direction: column;
gap: 10px;
}

.search-container {
position: relative;
}

#search {
width: 100%;
padding: 12px 15px;
border: 1px solid var(--accent-dark);
border-radius: 20px;
background-color: var(--secondary-dark);
color: var(--text-dark);
font-size: 0.95rem;
transition: all 0.2s var(--transition-function);
}

body.day-mode #search {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
color: var(--text-light);
}

body.black-mode #search {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
color: var(--text-black);
}

body.eye-mode #search {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
color: var(--text-eye);
}

#search:focus {
outline: none;
border-color: var(--highlight-dark);
box-shadow: none;
}

body.black-mode #search:focus {
border-color: var(--highlight-black);
}

body.eye-mode #search:focus {
border-color: var(--highlight-eye);
}

.search-icon {
position: absolute;
right: 15px;
top: 50%;
transform: translateY(-50%);
color: var(--text-dark);
opacity: 0.6;
}

body.day-mode .search-icon {
color: var(--text-light);
}

body.black-mode .search-icon {
color: var(--text-black);
}

body.eye-mode .search-icon {
color: var(--text-eye);
}

.controls-row {
display: flex;
gap: 10px;
}

#author-select {
flex: 1;
padding: 12px 15px;
border: 1px solid var(--accent-dark);
border-radius: 20px;
background-color: var(--secondary-dark);
color: var(--text-dark);
font-size: 0.95rem;
appearance: none;
background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
background-repeat: no-repeat;
background-position: right 15px center;
background-size: 16px;
transition: all 0.2s var(--transition-function);
}

body.day-mode #author-select {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
color: var(--text-light);
background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%230f1419' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
}

body.black-mode #author-select {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
color: var(--text-black);
background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23e0e0e0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
}

body.eye-mode #author-select {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
color: var(--text-eye);
background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23d4d4d4' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
}

#author-select:focus {
outline: none;
border-color: var(--highlight-dark);
box-shadow: none;
}

body.black-mode #author-select:focus {
border-color: var(--highlight-black);
}

body.eye-mode #author-select:focus {
border-color: var(--highlight-eye);
}

#show-saved {
padding: 12px 20px;
border: none;
border-radius: 20px;
background-color: var(--highlight-dark);
color: white;
font-size: 0.95rem;
cursor: pointer;
display: flex;
align-items: center;
gap: 8px;
transition: background-color 0.2s var(--transition-function);
}

body.black-mode #show-saved {
background-color: var(--highlight-black);
}

body.eye-mode #show-saved {
background-color: var(--highlight-eye);
}

#show-saved:hover {
background-color: #1a91da;
}

body.black-mode #show-saved:hover {
background-color: #3a8eff;
}

body.eye-mode #show-saved:hover {
background-color: #6b9bd4;
}

#loading-bar {
width: 100%;
height: 4px;
background: var(--accent-dark);
border-radius: 2px;
overflow: hidden;
display: none;
}

#loading-bar .progress {
width: 0%;
height: 100%;
background: var(--highlight-dark);
border-radius: 2px;
animation: loadingProgress 1.5s infinite ease-in-out;
}

body.day-mode #loading-bar {
background: var(--accent-light);
}

body.black-mode #loading-bar {
background: var(--accent-black);
}

body.eye-mode #loading-bar {
background: var(--accent-eye);
}

body.black-mode #loading-bar .progress {
background: var(--highlight-black);
}

body.eye-mode #loading-bar .progress {
background: var(--highlight-eye);
}

/* Audio Controls Styles */
.audio-controls {
display: flex;
align-items: center;
gap: 8px;
}

.audio-btn {
background: none;
border: 1px solid var(--accent-dark);
color: var(--text-dark);
font-size: 0.9rem;
cursor: pointer;
padding: 8px 12px;
border-radius: 20px;
display: flex;
align-items: center;
justify-content: center;
gap: 6px;
transition: all 0.2s var(--transition-function);
min-width: 40px;
height: 36px;
}

body.day-mode .audio-btn {
border-color: var(--accent-light);
color: var(--text-light);
}

body.black-mode .audio-btn {
border-color: var(--accent-black);
color: var(--text-black);
}

body.eye-mode .audio-btn {
border-color: var(--accent-eye);
color: var(--text-eye);
}

.audio-btn:hover {
background-color: var(--accent-dark);
border-color: var(--highlight-dark);
}

body.day-mode .audio-btn:hover {
background-color: var(--accent-light);
border-color: var(--highlight-light);
}

body.black-mode .audio-btn:hover {
background-color: var(--accent-black);
border-color: var(--highlight-black);
}

body.eye-mode .audio-btn:hover {
background-color: var(--accent-eye);
border-color: var(--highlight-eye);
}

.audio-btn.playing {
background-color: var(--highlight-dark);
border-color: var(--highlight-dark);
color: white;
}

body.black-mode .audio-btn.playing {
background-color: var(--highlight-black);
border-color: var(--highlight-black);
}

body.eye-mode .audio-btn.playing {
background-color: var(--highlight-eye);
border-color: var(--highlight-eye);
}

.audio-btn:disabled {
opacity: 0.5;
cursor: not-allowed;
}

/* Audio Player Styles - ENHANCED FOR MOBILE */
.audio-player {
position: fixed;
bottom: 0;
left: 0;
right: 0;
background: linear-gradient(135deg, var(--secondary-dark), var(--accent-dark));
border-top: 1px solid var(--accent-dark);
padding: 15px 20px;
z-index: 100;
transform: translateY(100%);
transition: transform 0.3s var(--transition-function);
backdrop-filter: blur(10px);
box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.3);
}

body.day-mode .audio-player {
background: linear-gradient(135deg, var(--secondary-light), var(--accent-light));
border-top: 1px solid var(--accent-light);
box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.1);
}

body.black-mode .audio-player {
background: linear-gradient(135deg, var(--secondary-black), var(--accent-black));
border-top: 1px solid var(--accent-black);
box-shadow: 0 -5px 20px rgba(255, 255, 255, 0.1);
}

body.eye-mode .audio-player {
background: linear-gradient(135deg, var(--secondary-eye), var(--accent-eye));
border-top: 1px solid var(--accent-eye);
box-shadow: 0 -5px 20px rgba(255, 255, 255, 0.05);
}

.audio-player.active {
transform: translateY(0);
}

.audio-player-content {
display: flex;
align-items: center;
gap: 15px;
max-width: 1200px;
margin: 0 auto;
}

.audio-info {
flex: 1;
min-width: 0;
}

.audio-title {
font-size: 1rem;
font-weight: 600;
color: var(--text-dark);
margin-bottom: 4px;
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
}

body.day-mode .audio-title {
color: var(--text-light);
}

body.black-mode .audio-title {
color: var(--text-black);
}

body.eye-mode .audio-title {
color: var(--text-eye);
}

.audio-subtitle {
font-size: 0.8rem;
color: var(--text-dark);
opacity: 0.7;
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
}

body.day-mode .audio-subtitle {
color: var(--text-light);
}

body.black-mode .audio-subtitle {
color: var(--text-black);
}

body.eye-mode .audio-subtitle {
color: var(--text-eye);
}

.audio-controls-main {
display: flex;
align-items: center;
gap: 12px;
}

.audio-control-btn {
background: none;
border: none;
color: var(--text-dark);
font-size: 1.3rem;
cursor: pointer;
padding: 12px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: all 0.2s var(--transition-function);
width: 50px;
height: 50px;
}

body.day-mode .audio-control-btn {
color: var(--text-light);
}

body.black-mode .audio-control-btn {
color: var(--text-black);
}

body.eye-mode .audio-control-btn {
color: var(--text-eye);
}

.audio-control-btn:hover {
background-color: var(--accent-dark);
color: var(--highlight-dark);
}

body.day-mode .audio-control-btn:hover {
background-color: var(--accent-light);
color: var(--highlight-light);
}

body.black-mode .audio-control-btn:hover {
background-color: var(--accent-black);
color: var(--highlight-black);
}

body.eye-mode .audio-control-btn:hover {
background-color: var(--accent-eye);
color: var(--highlight-eye);
}

.audio-play-btn {
background-color: var(--highlight-dark);
color: white;
font-size: 1.5rem;
width: 60px;
height: 60px;
}

body.black-mode .audio-play-btn {
background-color: var(--highlight-black);
}

body.eye-mode .audio-play-btn {
background-color: var(--highlight-eye);
}

.audio-play-btn:hover {
background-color: var(--highlight-dark);
transform: scale(1.05);
}

body.black-mode .audio-play-btn:hover {
background-color: var(--highlight-black);
}

body.eye-mode .audio-play-btn:hover {
background-color: var(--highlight-eye);
}

.audio-progress-container {
flex: 1;
display: flex;
flex-direction: column;
gap: 8px;
min-width: 200px;
}

.audio-progress {
width: 100%;
height: 8px;
background-color: var(--accent-dark);
border-radius: 4px;
overflow: hidden;
cursor: pointer;
position: relative;
}

body.day-mode .audio-progress {
background-color: var(--accent-light);
}

body.black-mode .audio-progress {
background-color: var(--accent-black);
}

body.eye-mode .audio-progress {
background-color: var(--accent-eye);
}

.audio-progress-bar {
height: 100%;
background-color: var(--highlight-dark);
border-radius: 4px;
width: 0%;
transition: width 0.1s ease;
position: relative;
}

body.black-mode .audio-progress-bar {
background-color: var(--highlight-black);
}

body.eye-mode .audio-progress-bar {
background-color: var(--highlight-eye);
}

.audio-progress-bar::after {
content: '';
position: absolute;
right: -8px;
top: 50%;
transform: translateY(-50%);
width: 16px;
height: 16px;
background-color: var(--highlight-dark);
border-radius: 50%;
opacity: 0;
transition: opacity 0.2s ease;
}

body.black-mode .audio-progress-bar::after {
background-color: var(--highlight-black);
}

body.eye-mode .audio-progress-bar::after {
background-color: var(--highlight-eye);
}

.audio-progress:hover .audio-progress-bar::after {
opacity: 1;
}

.audio-time {
display: flex;
justify-content: space-between;
font-size: 0.75rem;
color: var(--text-dark);
opacity: 0.7;
}

body.day-mode .audio-time {
color: var(--text-light);
}

body.black-mode .audio-time {
color: var(--text-black);
}

body.eye-mode .audio-time {
color: var(--text-eye);
}

.audio-volume {
display: flex;
align-items: center;
gap: 8px;
}

.volume-slider {
width: 80px;
height: 6px;
background-color: var(--accent-dark);
border-radius: 3px;
outline: none;
cursor: pointer;
-webkit-appearance: none;
}

body.day-mode .volume-slider {
background-color: var(--accent-light);
}

body.black-mode .volume-slider {
background-color: var(--accent-black);
}

body.eye-mode .volume-slider {
background-color: var(--accent-eye);
}

.volume-slider::-webkit-slider-thumb {
-webkit-appearance: none;
width: 16px;
height: 16px;
border-radius: 50%;
background-color: var(--highlight-dark);
cursor: pointer;
}

body.black-mode .volume-slider::-webkit-slider-thumb {
background-color: var(--highlight-black);
}

body.eye-mode .volume-slider::-webkit-slider-thumb {
background-color: var(--highlight-eye);
}

.volume-slider::-moz-range-thumb {
width: 16px;
height: 16px;
border-radius: 50%;
background-color: var(--highlight-dark);
cursor: pointer;
border: none;
}

body.black-mode .volume-slider::-moz-range-thumb {
background-color: var(--highlight-black);
}

body.eye-mode .volume-slider::-moz-range-thumb {
background-color: var(--highlight-eye);
}

.audio-close-btn {
color: var(--text-dark);
opacity: 0.7;
font-size: 1.2rem;
}

body.day-mode .audio-close-btn {
color: var(--text-light);
}

body.black-mode .audio-close-btn {
color: var(--text-black);
}

body.eye-mode .audio-close-btn {
color: var(--text-eye);
}

.audio-close-btn:hover {
opacity: 1;
color: #e53e3e;
}

/* Mobile Audio Player Adjustments - ENHANCED */
@media (max-width: 768px) {
.audio-player {
padding: 14px 30px;
padding-bottom: -3px;
}

.audio-player-content {
flex-direction: column;
gap: 15px;
}

.audio-info {
text-align: center;
order: 1;
}

.audio-controls-main {
order: 2;
justify-content: center;
gap: 20px;
}

.audio-progress-container {
order: 3;
min-width: auto;
width: 100%;
}

.audio-progress {
height: 12px;
}

.audio-progress-bar::after {
width: 20px;
height: 20px;
right: -10px;
}

.audio-volume {
display: none;
}

.audio-close-btn {
position: absolute;
top: 15px;
right: 15px;
}

.audio-title {
font-size: 1.1rem;
}

.audio-subtitle {
font-size: 0.85rem;
}

.audio-control-btn {
width: 55px;
height: 55px;
font-size: 1.4rem;
}

.audio-play-btn {
width: 70px;
height: 70px;
font-size: 1.8rem;
}

.audio-time {
font-size: 0.85rem;
margin-top: 5px;
}

body.audio-playing .content {
padding-bottom: 200px;
}
}

/* Desktop Audio Player Adjustments */
@media (min-width: 769px) {
body.audio-playing .content {
padding-bottom: 120px;
}
}

/* Surah List */
#surahs {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
gap: 15px;
margin-bottom: 20px;
}

.surah {
background-color: var(--secondary-dark);
padding: 15px;
border-radius: 12px;
cursor: pointer;
transition: all 0.2s var(--transition-function);
border: 1px solid var(--accent-dark);
position: relative;
display: flex;
align-items: center;
justify-content: space-between;
}

body.day-mode .surah {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
}

body.black-mode .surah {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
}

body.eye-mode .surah {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
}

.surah:hover {
transform: translateY(-3px);
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
border-color: var(--highlight-dark);
}

body.day-mode .surah:hover {
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
}

body.black-mode .surah:hover {
box-shadow: 0 5px 15px rgba(255, 255, 255, 0.05);
border-color: var(--highlight-black);
}

body.eye-mode .surah:hover {
box-shadow: 0 5px 15px rgba(255, 255, 255, 0.03);
border-color: var(--highlight-eye);
}

.surah h2 {
font-size: 1.1rem;
font-weight: 500;
margin: 0;
flex: 1;
}

.surah-audio-controls {
display: flex;
align-items: center;
opacity: 0;
transition: opacity 0.2s var(--transition-function);
}

.surah:hover .surah-audio-controls {
opacity: 1;
}

@media (max-width: 768px) {
.surah {
flex-direction: row;
align-items: center;
gap: 25px;
}

.surah h2 {
flex: 1;
}

.surah-audio-controls {
opacity: 1;
position: static;
}

#surahs {
grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
gap: 12px;
}
}

.verse-result {
background-color: var(--secondary-dark);
padding: 15px;
border-radius: 12px;
cursor: pointer;
transition: all 0.2s var(--transition-function);
border: 1px solid var(--accent-dark);
margin-bottom: 10px;
}

body.day-mode .verse-result {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
}

body.black-mode .verse-result {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
}

body.eye-mode .verse-result {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
}

.verse-result:hover {
transform: translateY(-3px);
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
border-color: var(--highlight-dark);
}

body.day-mode .verse-result:hover {
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
}

body.black-mode .verse-result:hover {
box-shadow: 0 5px 15px rgba(255, 255, 255, 0.05);
border-color: var(--highlight-black);
}

body.eye-mode .verse-result:hover {
box-shadow: 0 5px 15px rgba(255, 255, 255, 0.03);
border-color: var(--highlight-eye);
}

/* Verse Panel */
#verse-panel {
background-color: var(--secondary-dark);
border-radius: 12px;
padding: 20px;
margin-bottom: 20px;
display: none;
border: 1px solid var(--accent-dark);
}

body.day-mode #verse-panel {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
}

body.black-mode #verse-panel {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
}

body.eye-mode #verse-panel {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
}

#verse-panel.active {
display: block;
}

#verse-panel h3 {
font-size: 1.5rem;
margin-bottom: 20px;
padding-bottom: 10px;
border-bottom: 1px solid var(--accent-dark);
display: flex;
align-items: center;
gap: 10px;
}

body.day-mode #verse-panel h3 {
border-bottom: 1px solid var(--accent-light);
}

body.black-mode #verse-panel h3 {
border-bottom: 1px solid var(--accent-black);
}

body.eye-mode #verse-panel h3 {
border-bottom: 1px solid var(--accent-eye);
}

.verse-panel-header {
display: flex;
align-items: center;
justify-content: space-between;
margin-bottom: 20px;
padding-bottom: 10px;
border-bottom: 1px solid var(--accent-dark);
}

body.day-mode .verse-panel-header {
border-bottom: 1px solid var(--accent-light);
}

body.black-mode .verse-panel-header {
border-bottom: 1px solid var(--accent-black);
}

body.eye-mode .verse-panel-header {
border-bottom: 1px solid var(--accent-eye);
}

.verse-panel-title {
display: flex;
align-items: center;
gap: 10px;
}

#close-panel {
background: none;
border: none;
color: var(--text-dark);
font-size: 1.2rem;
cursor: pointer;
padding: 8px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: background-color 0.2s var(--transition-function);
}

body.day-mode #close-panel {
color: var(--text-light);
}

body.black-mode #close-panel {
color: var(--text-black);
}

body.eye-mode #close-panel {
color: var(--text-eye);
}

#close-panel:hover {
background-color: var(--accent-dark);
}

body.day-mode #close-panel:hover {
background-color: var(--accent-light);
}

body.black-mode #close-panel:hover {
background-color: var(--accent-black);
}

body.eye-mode #close-panel:hover {
background-color: var(--accent-eye);
}

.verse {
padding: 12px 0;
border-bottom: 1px solid var(--accent-dark);
display: flex;
justify-content: space-between;
align-items: center;
cursor: pointer;
transition: all 0.2s var(--transition-function);
font-size: var(--verse-font-size);
position: relative;
}

body.day-mode .verse {
border-bottom: 1px solid var(--accent-light);
}

body.black-mode .verse {
border-bottom: 1px solid var(--accent-black);
}

body.eye-mode .verse {
border-bottom: 1px solid var(--accent-eye);
}

.verse:last-child {
border-bottom: none;
}

.verse:hover {
padding-left: 5px;
}

.verse-actions {
display: flex;
gap: 10px;
opacity: 0;
transition: opacity 0.2s var(--transition-function);
}

@media (min-width: 769px) {
.verse:hover .verse-actions {
opacity: 1;
}
}

@media (max-width: 768px) {
.verse-actions {
position: absolute;
right: 10px;
top: 50%;
transform: translateY(-50%);
background-color: var(--secondary-dark);
border-radius: 20px;
padding: 5px;
box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
z-index: 10;
opacity: 0;
visibility: hidden;
transition: all 0.3s var(--transition-function);
pointer-events: none;
}

body.day-mode .verse-actions {
background-color: var(--secondary-light);
box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

body.black-mode .verse-actions {
background-color: var(--secondary-black);
box-shadow: 0 4px 12px rgba(255, 255, 255, 0.1);
}

body.eye-mode .verse-actions {
background-color: var(--secondary-eye);
box-shadow: 0 4px 12px rgba(255, 255, 255, 0.05);
}

.verse-actions.show {
opacity: 1;
visibility: visible;
pointer-events: auto;
}

.verse-actions::before {
content: '';
position: absolute;
left: -8px;
top: 50%;
transform: translateY(-50%);
width: 0;
height: 0;
border-top: 8px solid transparent;
border-bottom: 8px solid transparent;
border-right: 8px solid var(--secondary-dark);
}

body.day-mode .verse-actions::before {
border-right-color: var(--secondary-light);
}

body.black-mode .verse-actions::before {
border-right-color: var(--secondary-black);
}

body.eye-mode .verse-actions::before {
border-right-color: var(--secondary-eye);
}

.verse.scroll-disabled {
pointer-events: none;
}

.verse.scroll-disabled .verse-actions {
opacity: 0 !important;
visibility: hidden !important;
pointer-events: none !important;
}
}

.verse .save-btn,
.verse .share-btn {
background: none;
border: none;
color: var(--text-dark);
font-size: 1rem;
cursor: pointer;
padding: 8px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: background-color 0.2s var(--transition-function);
}

body.day-mode .verse .save-btn,
body.day-mode .verse .share-btn {
color: var(--text-light);
}

body.black-mode .verse .save-btn,
body.black-mode .verse .share-btn {
color: var(--text-black);
}

body.eye-mode .verse .save-btn,
body.eye-mode .verse .share-btn {
color: var(--text-eye);
}

.verse .save-btn:hover,
.verse .share-btn:hover {
background-color: var(--accent-dark);
}

body.day-mode .verse .save-btn:hover,
body.day-mode .verse .share-btn:hover {
background-color: var(--accent-light);
}

body.black-mode .verse .save-btn:hover,
body.black-mode .verse .share-btn:hover {
background-color: var(--accent-black);
}

body.eye-mode .verse .save-btn:hover,
body.eye-mode .verse .share-btn:hover {
background-color: var(--accent-eye);
}

.verse .save-btn.active {
color: var(--highlight-dark);
}

body.black-mode .verse .save-btn.active {
color: var(--highlight-black);
}

body.eye-mode .verse .save-btn.active {
color: var(--highlight-eye);
}

/* Verse Detail Panel - RESPONSIVE TASARIM DÜZELTMESİ */
#verse-detail-panel {
background-color: var(--secondary-dark);
border-radius: 12px;
padding: 20px;
margin-bottom: 20px;
display: none;
border: 1px solid var(--accent-dark);
position: relative;
touch-action: pan-y;
}

body.day-mode #verse-detail-panel {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
}

body.black-mode #verse-detail-panel {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
}

body.eye-mode #verse-detail-panel {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
}

#verse-detail-panel.active {
display: block;
}

#verse-detail-panel h3 {
font-size: 1.5rem;
margin-bottom: 20px;
padding-bottom: 10px;
border-bottom: 1px solid var(--accent-dark);
text-align: center;
position: relative;
}

body.day-mode #verse-detail-panel h3 {
border-bottom: 1px solid var(--accent-light);
}

body.black-mode #verse-detail-panel h3 {
border-bottom: 1px solid var(--accent-black);
}

body.eye-mode #verse-detail-panel h3 {
border-bottom: 1px solid var(--accent-eye);
}

#verse-detail-panel .back-btn {
position: absolute;
left: 0;
top: 0;
background: none;
border: none;
color: var(--text-dark);
font-size: 1.2rem;
cursor: pointer;
padding: 8px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: background-color 0.2s var(--transition-function);
}

body.day-mode #verse-detail-panel .back-btn {
color: var(--text-light);
}

body.black-mode #verse-detail-panel .back-btn {
color: var(--text-black);
}

body.eye-mode #verse-detail-panel .back-btn {
color: var(--text-eye);
}

#verse-detail-panel .back-btn:hover {
background-color: var(--accent-dark);
}

body.day-mode #verse-detail-panel .back-btn:hover {
background-color: var(--accent-light);
}

body.black-mode #verse-detail-panel .back-btn:hover {
background-color: var(--accent-black);
}

body.eye-mode #verse-detail-panel .back-btn:hover {
background-color: var(--accent-eye);
}

#verse-detail-panel .selected-translation {
background-color: var(--highlight-dark);
padding: 20px;
border-radius: 12px;
margin-bottom: 20px;
font-size: 1.1rem;
line-height: 1.6;
border: 1px solid var(--highlight-dark);
color: white;
font-weight: 500;
box-shadow: none;
font-size: var(--verse-font-size);
}

body.black-mode #verse-detail-panel .selected-translation {
background-color: var(--highlight-black);
border: 1px solid var(--highlight-black);
}

body.eye-mode #verse-detail-panel .selected-translation {
background-color: var(--highlight-eye);
border: 1px solid var(--highlight-eye);
}

@media (min-width: 1024px) {
.verse-content-container {
display: grid;
grid-template-columns: 1fr 2fr 1fr;
gap: 30px;
align-items: start;
}

.verse-main-content {
grid-column: 2;
display: flex;
flex-direction: column;
gap: 20px;
}

.verse-left-sidebar {
grid-column: 1;
background-color: var(--accent-dark);
border-radius: 12px;
padding: 20px;
border: 1px solid var(--accent-dark);
}

body.day-mode .verse-left-sidebar {
background-color: var(--accent-light);
border: 1px solid var(--accent-light);
}

body.black-mode .verse-left-sidebar {
background-color: var(--accent-black);
border: 1px solid var(--accent-black);
}

body.eye-mode .verse-left-sidebar {
background-color: var(--accent-eye);
border: 1px solid var(--accent-eye);
}

.verse-right-sidebar {
grid-column: 3;
background-color: var(--accent-dark);
border-radius: 12px;
padding: 20px;
border: 1px solid var(--accent-dark);
}

body.day-mode .verse-right-sidebar {
background-color: var(--accent-light);
border: 1px solid var(--accent-light);
}

body.black-mode .verse-right-sidebar {
background-color: var(--accent-black);
border: 1px solid var(--accent-black);
}

body.eye-mode .verse-right-sidebar {
background-color: var(--accent-eye);
border: 1px solid var(--accent-eye);
}

.sidebar-title {
font-size: 1.1rem;
font-weight: 600;
margin-bottom: 15px;
color: var(--highlight-dark);
text-align: center;
border-bottom: 2px solid var(--highlight-dark);
padding-bottom: 8px;
display: flex;
align-items: center;
justify-content: space-between;
}

body.black-mode .sidebar-title {
color: var(--highlight-black);
border-bottom-color: var(--highlight-black);
}

body.eye-mode .sidebar-title {
color: var(--highlight-eye);
border-bottom-color: var(--highlight-eye);
}

.verse-navigation-buttons {
display: flex;
justify-content: space-between;
align-items: center;
gap: 15px;
margin: 20px 0;
}

.verse-navigation-audio {
display: flex;
align-items: center;
gap: 10px;
}

.verse-detail-actions {
display: flex;
align-items: center;
gap: 10px;
}

.nav-btn {
background: var(--highlight-dark);
border: none;
color: white;
font-size: 1rem;
cursor: pointer;
padding: 12px 20px;
border-radius: 25px;
display: flex;
align-items: center;
justify-content: center;
gap: 8px;
transition: all 0.2s var(--transition-function);
box-shadow: none;
min-width: 120px;
}

body.black-mode .nav-btn {
background: var(--highlight-black);
}

body.eye-mode .nav-btn {
background: var(--highlight-eye);
}

.nav-btn:hover {
background-color: #1a91da;
transform: translateY(-2px);
box-shadow: none;
}

body.black-mode .nav-btn:hover {
background-color: #3a8eff;
}

body.eye-mode .nav-btn:hover {
background-color: #6b9bd4;
}

.tab-container {
display: none;
}
}

@media (max-width: 1023px) {
.verse-content-container {
display: flex;
flex-direction: column;
gap: 20px;
}

.verse-main-content {
order: 1;
}

.verse-left-sidebar,
.verse-right-sidebar {
display: none;
}

.tab-container {
margin-top: 20px;
display: block;
}

.tab-buttons {
display: flex;
border-bottom: 1px solid var(--accent-dark);
margin-bottom: 15px;
}

body.day-mode .tab-buttons {
border-bottom: 1px solid var(--accent-light);
}

body.black-mode .tab-buttons {
border-bottom: 1px solid var(--accent-black);
}

body.eye-mode .tab-buttons {
border-bottom: 1px solid var(--accent-eye);
}

.tab-header {
display: flex;
align-items: center;
gap: 5px;
flex: 1;
}

.tab-button {
padding: 10px 20px;
background: none;
border: none;
color: var(--text-dark);
cursor: pointer;
font-size: 0.95rem;
position: relative;
transition: all 0.2s var(--transition-function);
flex: 1;
text-align: center;
}

body.day-mode .tab-button {
color: var(--text-light);
}

body.black-mode .tab-button {
color: var(--text-black);
}

body.eye-mode .tab-button {
color: var(--text-eye);
}

.tab-button.active {
color: var(--highlight-dark);
font-weight: 500;
}

body.black-mode .tab-button.active {
color: var(--highlight-black);
}

body.eye-mode .tab-button.active {
color: var(--highlight-eye);
}

.tab-button.active::after {
content: '';
position: absolute;
bottom: -1px;
left: 0;
width: 100%;
height: 2px;
background-color: var(--highlight-dark);
}

body.black-mode .tab-button.active::after {
background-color: var(--highlight-black);
}

body.eye-mode .tab-button.active::after {
background-color: var(--highlight-eye);
}

.tab-content {
display: none;
}

.tab-content.active {
display: block;
}

.verse-navigation-buttons {
display: flex;
justify-content: space-between;
align-items: center;
margin: 20px 0;
gap: 8px;
flex-wrap: wrap;
}

.verse-navigation-audio {
display: flex;
align-items: center;
gap: 8px;
}

.verse-detail-actions {
display: flex;
align-items: center;
gap: 8px;
}

.nav-btn {
background: var(--highlight-dark);
border: none;
color: white;
font-size: 0.8rem;
cursor: pointer;
padding: 8px 12px;
border-radius: 15px;
display: flex;
align-items: center;
justify-content: center;
gap: 4px;
transition: background-color 0.2s var(--transition-function);
min-width: 80px;
}

body.black-mode .nav-btn {
background: var(--highlight-black);
}

body.eye-mode .nav-btn {
background: var(--highlight-eye);
}

.nav-btn:hover {
background-color: #1a91da;
}

body.black-mode .nav-btn:hover {
background-color: #3a8eff;
}

body.eye-mode .nav-btn:hover {
background-color: #6b9bd4;
}
}

.verse-detail-save-btn,
.verse-detail-share-btn {
background: none;
border: 1px solid var(--accent-dark);
color: var(--text-dark);
font-size: 0.8rem;
cursor: pointer;
padding: 8px 12px;
border-radius: 15px;
display: flex;
align-items: center;
justify-content: center;
gap: 4px;
transition: all 0.2s var(--transition-function);
min-width: 80px;
}

body.day-mode .verse-detail-save-btn,
body.day-mode .verse-detail-share-btn {
border-color: var(--accent-light);
color: var(--text-light);
}

body.black-mode .verse-detail-save-btn,
body.black-mode .verse-detail-share-btn {
border-color: var(--accent-black);
color: var(--text-black);
}

body.eye-mode .verse-detail-save-btn,
body.eye-mode .verse-detail-share-btn {
border-color: var(--accent-eye);
color: var(--text-eye);
}

.verse-detail-save-btn:hover,
.verse-detail-share-btn:hover {
background-color: var(--accent-dark);
border-color: var(--highlight-dark);
}

body.day-mode .verse-detail-save-btn:hover,
body.day-mode .verse-detail-share-btn:hover {
background-color: var(--accent-light);
border-color: var(--highlight-light);
}

body.black-mode .verse-detail-save-btn:hover,
body.black-mode .verse-detail-share-btn:hover {
background-color: var(--accent-black);
border-color: var(--highlight-black);
}

body.eye-mode .verse-detail-save-btn:hover,
body.eye-mode .verse-detail-share-btn:hover {
background-color: var(--accent-eye);
border-color: var(--highlight-eye);
}

.verse-detail-save-btn.active {
color: var(--highlight-dark);
border-color: var(--highlight-dark);
background-color: rgba(29, 161, 242, 0.1);
}

body.black-mode .verse-detail-save-btn.active {
color: var(--highlight-black);
border-color: var(--highlight-black);
background-color: rgba(74, 158, 255, 0.1);
}

body.eye-mode .verse-detail-save-btn.active {
color: var(--highlight-eye);
border-color: var(--highlight-eye);
background-color: rgba(123, 167, 217, 0.1);
}

#verse-detail-panel .other-translations {
display: flex;
flex-direction: column;
gap: 20px;
padding: 10px 0;
}

#verse-detail-panel .other-translations .translation-item {
position: relative;
background-color: var(--secondary-dark);
border: 1px solid var(--accent-dark);
border-radius: 12px;
padding: 20px 15px 15px 15px;
transition: all 0.3s var(--transition-function);
animation: fadeInUp 0.4s ease-out;
}

body.day-mode #verse-detail-panel .other-translations .translation-item {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
}

body.black-mode #verse-detail-panel .other-translations .translation-item {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
}

body.eye-mode #verse-detail-panel .other-translations .translation-item {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
}

#verse-detail-panel .other-translations .translation-item:hover {
transform: translateY(-2px);
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
border-color: var(--highlight-dark);
}

body.day-mode #verse-detail-panel .other-translations .translation-item:hover {
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
}

body.black-mode #verse-detail-panel .other-translations .translation-item:hover {
box-shadow: 0 8px 25px rgba(255, 255, 255, 0.08);
border-color: var(--highlight-black);
}

body.eye-mode #verse-detail-panel .other-translations .translation-item:hover {
box-shadow: 0 8px 25px rgba(255, 255, 255, 0.05);
border-color: var(--highlight-eye);
}

#verse-detail-panel .other-translations .floating-label {
position: absolute;
top: -8px;
left: 15px;
background-color: var(--highlight-dark);
color: white;
padding: 4px 12px;
border-radius: 20px;
font-size: 0.8rem;
font-weight: 600;
letter-spacing: 0.5px;
box-shadow: none;
z-index: 2;
}

body.black-mode #verse-detail-panel .other-translations .floating-label {
background-color: var(--highlight-black);
}

body.eye-mode #verse-detail-panel .other-translations .floating-label {
background-color: var(--highlight-eye);
}

#verse-detail-panel .other-translations .translation-text {
color: var(--text-dark);
font-size: var(--verse-font-size);
line-height: 1.6;
margin: 0;
padding-top: 5px;
}

body.day-mode #verse-detail-panel .other-translations .translation-text {
color: var(--text-light);
}

body.black-mode #verse-detail-panel .other-translations .translation-text {
color: var(--text-black);
}

body.eye-mode #verse-detail-panel .other-translations .translation-text {
color: var(--text-eye);
}

@keyframes fadeInUp {
from {
opacity: 0;
transform: translateY(20px);
}
to {
opacity: 1;
transform: translateY(0);
}
}

@media (max-width: 768px) {
#verse-detail-panel .other-translations .translation-item {
padding: 18px 12px 12px 12px;
}

#verse-detail-panel .other-translations .floating-label {
font-size: 0.75rem;
padding: 3px 10px;
left: 12px;
}

#verse-detail-panel .other-translations .translation-text {
font-size: 0.9rem;
}
}

.sort-authors-btn {
background: none;
border: none;
color: var(--highlight-dark);
font-size: 0.9rem;
cursor: pointer;
padding: 4px 8px;
border-radius: 15px;
display: flex;
align-items: center;
gap: 4px;
transition: all 0.2s var(--transition-function);
}

body.black-mode .sort-authors-btn {
color: var(--highlight-black);
}

body.eye-mode .sort-authors-btn {
color: var(--highlight-eye);
}

.sort-authors-btn:hover {
background-color: rgba(29, 161, 242, 0.1);
}

.author-sort-panel {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-color: rgba(0, 0, 0, 0.5);
z-index: 1000;
display: none;
align-items: center;
justify-content: center;
}

.author-sort-content {
background-color: var(--secondary-dark);
border-radius: 12px;
padding: 25px;
max-width: 500px;
width: 90%;
max-height: 80vh;
overflow-y: auto;
border: 1px solid var(--accent-dark);
}

body.day-mode .author-sort-content {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
}

body.black-mode .author-sort-content {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
}

body.eye-mode .author-sort-content {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
}

.author-sort-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 20px;
padding-bottom: 15px;
border-bottom: 1px solid var(--accent-dark);
}

body.day-mode .author-sort-header {
border-bottom: 1px solid var(--accent-light);
}

body.black-mode .author-sort-header {
border-bottom: 1px solid var(--accent-black);
}

body.eye-mode .author-sort-header {
border-bottom: 1px solid var(--accent-eye);
}

.author-sort-title {
font-size: 1.3rem;
font-weight: 600;
color: var(--text-dark);
}

body.day-mode .author-sort-title {
color: var(--text-light);
}

body.black-mode .author-sort-title {
color: var(--text-black);
}

body.eye-mode .author-sort-title {
color: var(--text-eye);
}

.close-sort-panel {
background: none;
border: none;
color: var(--text-dark);
font-size: 1.2rem;
cursor: pointer;
padding: 8px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: background-color 0.2s var(--transition-function);
}

body.day-mode .close-sort-panel {
color: var(--text-light);
}

body.black-mode .close-sort-panel {
color: var(--text-black);
}

body.eye-mode .close-sort-panel {
color: var(--text-eye);
}

.close-sort-panel:hover {
background-color: var(--accent-dark);
}

body.day-mode .close-sort-panel:hover {
background-color: var(--accent-light);
}

body.black-mode .close-sort-panel:hover {
background-color: var(--accent-black);
}

body.eye-mode .close-sort-panel:hover {
background-color: var(--accent-eye);
}

.author-list {
display: flex;
flex-direction: column;
gap: 10px;
margin-bottom: 20px;
}

.author-item {
background-color: var(--accent-dark);
border-radius: 8px;
padding: 15px;
border: 1px solid var(--accent-dark);
cursor: grab;
transition: all 0.2s var(--transition-function);
display: flex;
align-items: center;
justify-content: space-between;
}

body.day-mode .author-item {
background-color: var(--accent-light);
border: 1px solid var(--accent-light);
}

body.black-mode .author-item {
background-color: var(--accent-black);
border: 1px solid var(--accent-black);
}

body.eye-mode .author-item {
background-color: var(--accent-eye);
border: 1px solid var(--accent-eye);
}

.author-item:hover {
transform: translateY(-2px);
box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

body.day-mode .author-item:hover {
box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
}

body.black-mode .author-item:hover {
box-shadow: 0 4px 8px rgba(255, 255, 255, 0.05);
}

body.eye-mode .author-item:hover {
box-shadow: 0 4px 8px rgba(255, 255, 255, 0.03);
}

.author-item.dragging {
opacity: 0.5;
transform: rotate(5deg);
cursor: grabbing;
}

.author-name {
font-weight: 500;
color: var(--text-dark);
}

body.day-mode .author-name {
color: var(--text-light);
}

body.black-mode .author-name {
color: var(--text-black);
}

body.eye-mode .author-name {
color: var(--text-eye);
}

.drag-handle {
color: var(--text-dark);
opacity: 0.6;
font-size: 1.2rem;
}

body.day-mode .drag-handle {
color: var(--text-light);
}

body.black-mode .drag-handle {
color: var(--text-black);
}

body.eye-mode .drag-handle {
color: var(--text-eye);
}

.sort-actions {
display: flex;
gap: 10px;
justify-content: flex-end;
}

.sort-btn {
padding: 10px 20px;
border: none;
border-radius: 20px;
font-size: 0.9rem;
cursor: pointer;
transition: all 0.2s var(--transition-function);
}

.save-sort-btn {
background-color: var(--highlight-dark);
color: white;
}

body.black-mode .save-sort-btn {
background-color: var(--highlight-black);
}

body.eye-mode .save-sort-btn {
background-color: var(--highlight-eye);
}

.save-sort-btn:hover {
background-color: #1a91da;
}

body.black-mode .save-sort-btn:hover {
background-color: #3a8eff;
}

body.eye-mode .save-sort-btn:hover {
background-color: #6b9bd4;
}

.reset-sort-btn {
background-color: var(--accent-dark);
color: var(--text-dark);
}

body.day-mode .reset-sort-btn {
background-color: var(--accent-light);
color: var(--text-light);
}

body.black-mode .reset-sort-btn {
background-color: var(--accent-black);
color: var(--text-black);
}

body.eye-mode .reset-sort-btn {
background-color: var(--accent-eye);
color: var(--text-eye);
}

.reset-sort-btn:hover {
background-color: var(--highlight-dark);
color: white;
}

body.black-mode .reset-sort-btn:hover {
background-color: var(--highlight-black);
}

body.eye-mode .reset-sort-btn:hover {
background-color: var(--highlight-eye);
}

/* Saved Verses - YENİ TASARIM VE DÜZELTİLMİŞ FONKSİYON */
#saved-verses {
background-color: var(--secondary-dark);
border-radius: 12px;
padding: 20px;
margin-bottom: 20px;
display: none;
border: 1px solid var(--accent-dark);
}

body.day-mode #saved-verses {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
}

body.black-mode #saved-verses {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
}

body.eye-mode #saved-verses {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
}

#saved-verses h2 {
font-size: 1.8rem;
margin-bottom: 25px;
padding-bottom: 15px;
border-bottom: 2px solid var(--highlight-dark);
display: flex;
align-items: center;
justify-content: center;
gap: 12px;
color: var(--text-dark);
text-align: center;
}

body.day-mode #saved-verses h2 {
color: var(--text-light);
}

body.black-mode #saved-verses h2 {
color: var(--text-black);
border-bottom-color: var(--highlight-black);
}

body.eye-mode #saved-verses h2 {
color: var(--text-eye);
border-bottom-color: var(--highlight-eye);
}

#saved-verses h2 i {
color: var(--highlight-dark);
font-size: 1.5rem;
}

body.black-mode #saved-verses h2 i {
color: var(--highlight-black);
}

body.eye-mode #saved-verses h2 i {
color: var(--highlight-eye);
}

#saved-list {
display: flex;
flex-direction: column;
gap: 20px;
margin-bottom: 25px;
}

#saved-list .saved-verse-item {
background-color: var(--accent-dark);
border-radius: 12px;
padding: 20px;
border: 1px solid var(--accent-dark);
transition: all 0.3s var(--transition-function);
position: relative;
overflow: hidden;
}

body.day-mode #saved-list .saved-verse-item {
background-color: var(--accent-light);
border: 1px solid var(--accent-light);
}

body.black-mode #saved-list .saved-verse-item {
background-color: var(--accent-black);
border: 1px solid var(--accent-black);
}

body.eye-mode #saved-list .saved-verse-item {
background-color: var(--accent-eye);
border: 1px solid var(--accent-eye);
}

#saved-list .saved-verse-item:hover {
transform: translateY(-3px);
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
border-color: var(--highlight-dark);
}

body.day-mode #saved-list .saved-verse-item:hover {
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
}

body.black-mode #saved-list .saved-verse-item:hover {
box-shadow: 0 8px 25px rgba(255, 255, 255, 0.08);
border-color: var(--highlight-black);
}

body.eye-mode #saved-list .saved-verse-item:hover {
box-shadow: 0 8px 25px rgba(255, 255, 255, 0.05);
border-color: var(--highlight-eye);
}

#saved-list .saved-verse-item::before {
content: '';
position: absolute;
left: 0;
top: 0;
height: 100%;
width: 4px;
background: linear-gradient(45deg, var(--highlight-dark), #1a91da);
}

body.black-mode #saved-list .saved-verse-item::before {
background: linear-gradient(45deg, var(--highlight-black), #3a8eff);
}

body.eye-mode #saved-list .saved-verse-item::before {
background: linear-gradient(45deg, var(--highlight-eye), #6b9bd4);
}

.saved-verse-content {
margin-bottom: 15px;
}

.saved-verse-text {
font-size: var(--verse-font-size);
line-height: 1.6;
margin-bottom: 10px;
color: var(--text-dark);
}

body.day-mode .saved-verse-text {
color: var(--text-light);
}

body.black-mode .saved-verse-text {
color: var(--text-black);
}

body.eye-mode .saved-verse-text {
color: var(--text-eye);
}

.saved-verse-reference {
font-size: 0.9rem;
color: var(--highlight-dark);
font-weight: 500;
margin-bottom: 15px;
}

body.black-mode .saved-verse-reference {
color: var(--highlight-black);
}

body.eye-mode .saved-verse-reference {
color: var(--highlight-eye);
}

.saved-verse-note {
background-color: var(--secondary-dark);
border-radius: 8px;
padding: 12px;
margin-top: 10px;
border-left: 3px solid var(--highlight-dark);
}

body.day-mode .saved-verse-note {
background-color: var(--secondary-light);
}

body.black-mode .saved-verse-note {
background-color: var(--secondary-black);
border-left-color: var(--highlight-black);
}

body.eye-mode .saved-verse-note {
background-color: var(--secondary-eye);
border-left-color: var(--highlight-eye);
}

.saved-verse-note-label {
font-size: 0.8rem;
color: var(--highlight-dark);
font-weight: 600;
margin-bottom: 5px;
display: flex;
align-items: center;
gap: 5px;
}

body.black-mode .saved-verse-note-label {
color: var(--highlight-black);
}

body.eye-mode .saved-verse-note-label {
color: var(--highlight-eye);
}

.saved-verse-note-text {
font-size: 0.9rem;
color: var(--text-dark);
line-height: 1.4;
}

body.day-mode .saved-verse-note-text {
color: var(--text-light);
}

body.black-mode .saved-verse-note-text {
color: var(--text-black);
}

body.eye-mode .saved-verse-note-text {
color: var(--text-eye);
}

.saved-verse-actions {
display: flex;
justify-content: space-between;
align-items: center;
margin-top: 15px;
}

.saved-verse-buttons {
display: flex;
gap: 10px;
}

.saved-verse-btn {
background: none;
border: 1px solid var(--accent-dark);
color: var(--text-dark);
font-size: 0.85rem;
cursor: pointer;
padding: 6px 12px;
border-radius: 15px;
display: flex;
align-items: center;
gap: 5px;
transition: all 0.2s var(--transition-function);
}

body.day-mode .saved-verse-btn {
border-color: var(--accent-light);
color: var(--text-light);
}

body.black-mode .saved-verse-btn {
border-color: var(--accent-black);
color: var(--text-black);
}

body.eye-mode .saved-verse-btn {
border-color: var(--accent-eye);
color: var(--text-eye);
}

.saved-verse-btn:hover {
background-color: var(--accent-dark);
border-color: var(--highlight-dark);
}

body.day-mode .saved-verse-btn:hover {
background-color: var(--accent-light);
border-color: var(--highlight-light);
}

body.black-mode .saved-verse-btn:hover {
background-color: var(--accent-black);
border-color: var(--highlight-black);
}

body.eye-mode .saved-verse-btn:hover {
background-color: var(--accent-eye);
border-color: var(--highlight-eye);
}

.saved-verse-btn.edit-note {
color: var(--highlight-dark);
border-color: var(--highlight-dark);
}

body.black-mode .saved-verse-btn.edit-note {
color: var(--highlight-black);
border-color: var(--highlight-black);
}

body.eye-mode .saved-verse-btn.edit-note {
color: var(--highlight-eye);
border-color: var(--highlight-eye);
}

.saved-verse-btn.delete {
color: #e53e3e;
border-color: #e53e3e;
}

.saved-verse-btn.delete:hover {
background-color: rgba(229, 62, 62, 0.1);
}

.saved-verse-date {
font-size: 0.75rem;
color: var(--text-dark);
opacity: 0.6;
}

body.day-mode .saved-verse-date {
color: var(--text-light);
}

body.black-mode .saved-verse-date {
color: var(--text-black);
}

body.eye-mode .saved-verse-date {
color: var(--text-eye);
}

/* Note Modal */
.note-modal {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-color: rgba(0, 0, 0, 0.5);
z-index: 1000;
display: none;
align-items: center;
justify-content: center;
}

.note-modal-content {
background-color: var(--secondary-dark);
border-radius: 12px;
padding: 25px;
max-width: 500px;
width: 90%;
max-height: 80vh;
overflow-y: auto;
border: 1px solid var(--accent-dark);
}

body.day-mode .note-modal-content {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
}

body.black-mode .note-modal-content {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
}

body.eye-mode .note-modal-content {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
}

.note-modal-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 20px;
padding-bottom: 15px;
border-bottom: 1px solid var(--accent-dark);
}

body.day-mode .note-modal-header {
border-bottom: 1px solid var(--accent-light);
}

body.black-mode .note-modal-header {
border-bottom: 1px solid var(--accent-black);
}

body.eye-mode .note-modal-header {
border-bottom: 1px solid var(--accent-eye);
}

.note-modal-title {
font-size: 1.3rem;
font-weight: 600;
color: var(--text-dark);
}

body.day-mode .note-modal-title {
color: var(--text-light);
}

body.black-mode .note-modal-title {
color: var(--text-black);
}

body.eye-mode .note-modal-title {
color: var(--text-eye);
}

.close-note-modal {
background: none;
border: none;
color: var(--text-dark);
font-size: 1.2rem;
cursor: pointer;
padding: 8px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: background-color 0.2s var(--transition-function);
}

body.day-mode .close-note-modal {
color: var(--text-light);
}

body.black-mode .close-note-modal {
color: var(--text-black);
}

body.eye-mode .close-note-modal {
color: var(--text-eye);
}

.close-note-modal:hover {
background-color: var(--accent-dark);
}

body.day-mode .close-note-modal:hover {
background-color: var(--accent-light);
}

body.black-mode .close-note-modal:hover {
background-color: var(--accent-black);
}

body.eye-mode .close-note-modal:hover {
background-color: var(--accent-eye);
}

.note-verse-preview {
background-color: var(--accent-dark);
border-radius: 8px;
padding: 15px;
margin-bottom: 20px;
border-left: 3px solid var(--highlight-dark);
}

body.day-mode .note-verse-preview {
background-color: var(--accent-light);
}

body.black-mode .note-verse-preview {
background-color: var(--accent-black);
border-left-color: var(--highlight-black);
}

body.eye-mode .note-verse-preview {
background-color: var(--accent-eye);
border-left-color: var(--highlight-eye);
}

.note-verse-text {
font-size: 0.95rem;
line-height: 1.5;
margin-bottom: 8px;
color: var(--text-dark);
}

body.day-mode .note-verse-text {
color: var(--text-light);
}

body.black-mode .note-verse-text {
color: var(--text-black);
}

body.eye-mode .note-verse-text {
color: var(--text-eye);
}

.note-verse-ref {
font-size: 0.8rem;
color: var(--highlight-dark);
font-weight: 500;
}

body.black-mode .note-verse-ref {
color: var(--highlight-black);
}

body.eye-mode .note-verse-ref {
color: var(--highlight-eye);
}

.note-textarea {
width: 100%;
min-height: 120px;
padding: 15px;
border: 1px solid var(--accent-dark);
border-radius: 8px;
background-color: var(--primary-dark);
color: var(--text-dark);
font-size: 0.95rem;
font-family: inherit;
resize: vertical;
transition: border-color 0.2s var(--transition-function);
}

body.day-mode .note-textarea {
background-color: var(--primary-light);
border: 1px solid var(--accent-light);
color: var(--text-light);
}

body.black-mode .note-textarea {
background-color: var(--primary-black);
border: 1px solid var(--accent-black);
color: var(--text-black);
}

body.eye-mode .note-textarea {
background-color: var(--primary-eye);
border: 1px solid var(--accent-eye);
color: var(--text-eye);
}

.note-textarea:focus {
outline: none;
border-color: var(--highlight-dark);
}

body.black-mode .note-textarea:focus {
border-color: var(--highlight-black);
}

body.eye-mode .note-textarea:focus {
border-color: var(--highlight-eye);
}

.note-actions {
display: flex;
gap: 10px;
justify-content: flex-end;
margin-top: 20px;
}

.note-btn {
padding: 10px 20px;
border: none;
border-radius: 20px;
font-size: 0.9rem;
cursor: pointer;
transition: all 0.2s var(--transition-function);
display: flex;
align-items: center;
gap: 8px;
}

.save-note-btn {
background-color: var(--highlight-dark);
color: white;
}

body.black-mode .save-note-btn {
background-color: var(--highlight-black);
}

body.eye-mode .save-note-btn {
background-color: var(--highlight-eye);
}

.save-note-btn:hover {
background-color: #1a91da;
}

body.black-mode .save-note-btn:hover {
background-color: #3a8eff;
}

body.eye-mode .save-note-btn:hover {
background-color: #6b9bd4;
}

.cancel-note-btn {
background-color: var(--accent-dark);
color: var(--text-dark);
}

body.day-mode .cancel-note-btn {
background-color: var(--accent-light);
color: var(--text-light);
}

body.black-mode .cancel-note-btn {
background-color: var(--accent-black);
color: var(--text-black);
}

body.eye-mode .cancel-note-btn {
background-color: var(--accent-eye);
color: var(--text-eye);
}

.cancel-note-btn:hover {
background-color: var(--highlight-dark);
color: white;
}

body.black-mode .cancel-note-btn:hover {
background-color: var(--highlight-black);
}

body.eye-mode .cancel-note-btn:hover {
background-color: var(--highlight-eye);
}

#back-to-surahs {
padding: 15px 25px;
border: none;
border-radius: 25px;
background: linear-gradient(45deg, var(--highlight-dark), #1a91da);
color: white;
font-size: 1rem;
font-weight: 500;
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
gap: 10px;
margin: 0 auto;
transition: all 0.3s var(--transition-function);
box-shadow: none;
min-width: 200px;
}

body.black-mode #back-to-surahs {
background: linear-gradient(45deg, var(--highlight-black), #3a8eff);
}

body.eye-mode #back-to-surahs {
background: linear-gradient(45deg, var(--highlight-eye), #6b9bd4);
}

#back-to-surahs:hover {
transform: translateY(-2px);
box-shadow: none;
}

/* Search Page */
#search-page {
position: fixed;
top: 0;
left: 60px;
width: calc(100% - 60px);
height: 100%;
background-color: var(--primary-dark);
z-index: 100;
padding: 20px;
display: none;
overflow-y: auto;
transition: all 0.3s var(--transition-function);
}

body.day-mode #search-page {
background-color: var(--primary-light);
}

body.black-mode #search-page {
background-color: var(--primary-black);
}

body.eye-mode #search-page {
background-color: var(--primary-eye);
}

#search-page.active {
display: flex;
flex-direction: column;
}

.search-page-header {
display: flex;
align-items: center;
gap: 15px;
margin-bottom: 30px;
padding-bottom: 15px;
border-bottom: 1px solid var(--accent-dark);
}

body.day-mode .search-page-header {
border-bottom: 1px solid var(--accent-light);
}

body.black-mode .search-page-header {
border-bottom: 1px solid var(--accent-black);
}

body.eye-mode .search-page-header {
border-bottom: 1px solid var(--accent-eye);
}

.search-page-back {
background: none;
border: none;
color: var(--text-dark);
font-size: 1.2rem;
cursor: pointer;
padding: 8px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: background-color 0.2s var(--transition-function);
}

body.day-mode .search-page-back {
color: var(--text-light);
}

body.black-mode .search-page-back {
color: var(--text-black);
}

body.eye-mode .search-page-back {
color: var(--text-eye);
}

.search-page-back:hover {
background-color: var(--accent-dark);
}

body.day-mode .search-page-back:hover {
background-color: var(--accent-light);
}

body.black-mode .search-page-back:hover {
background-color: var(--accent-black);
}

body.eye-mode .search-page-back:hover {
background-color: var(--accent-eye);
}

.search-page-container {
display: flex;
gap: 20px;
flex: 1;
}

.search-page-main {
flex: 1;
}

.search-page-input-container {
position: relative;
margin-bottom: 30px;
}

#search-page-input {
width: 100%;
padding: 15px 20px;
border: 1px solid var(--accent-dark);
border-radius: 25px;
background-color: var(--secondary-dark);
color: var(--text-dark);
font-size: 1.1rem;
transition: all 0.2s var(--transition-function);
}

body.day-mode #search-page-input {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
color: var(--text-light);
}

body.black-mode #search-page-input {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
color: var(--text-black);
}

body.eye-mode #search-page-input {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
color: var(--text-eye);
}

#search-page-input:focus {
outline: none;
border-color: var(--highlight-dark);
box-shadow: none;
}

body.black-mode #search-page-input:focus {
border-color: var(--highlight-black);
}

body.eye-mode #search-page-input:focus {
border-color: var(--highlight-eye);
}

.search-page-icon {
position: absolute;
right: 20px;
top: 50%;
transform: translateY(-50%);
color: var(--text-dark);
opacity: 0.6;
font-size: 1.1rem;
}

body.day-mode .search-page-icon {
color: var(--text-light);
}

body.black-mode .search-page-icon {
color: var(--text-black);
}

body.eye-mode .search-page-icon {
color: var(--text-eye);
}

#search-results {
display: flex;
flex-direction: column;
gap: 10px;
}

.search-page-sidebar {
width: 250px;
padding: 20px;
background-color: var(--secondary-dark);
border-radius: 12px;
border: 1px solid var(--accent-dark);
align-self: flex-start;
position: sticky;
top: 20px;
}

body.day-mode .search-page-sidebar {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
}

body.black-mode .search-page-sidebar {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
}

body.eye-mode .search-page-sidebar {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
}

.search-page-sidebar h3 {
font-size: 1.1rem;
margin-bottom: 15px;
padding-bottom: 10px;
border-bottom: 1px solid var(--accent-dark);
}

body.day-mode .search-page-sidebar h3 {
border-bottom: 1px solid var(--accent-light);
}

body.black-mode .search-page-sidebar h3 {
border-bottom: 1px solid var(--accent-black);
}

body.eye-mode .search-page-sidebar h3 {
border-bottom: 1px solid var(--accent-eye);
}

.example-searches {
display: flex;
flex-direction: column;
gap: 10px;
}

.example-search {
padding: 8px 12px;
background-color: var(--accent-dark);
border-radius: 15px;
cursor: pointer;
transition: all 0.2s var(--transition-function);
font-size: 0.9rem;
display: flex;
align-items: center;
gap: 5px;
}

body.day-mode .example-search {
background-color: var(--accent-light);
}

body.black-mode .example-search {
background-color: var(--accent-black);
}

body.eye-mode .example-search {
background-color: var(--accent-eye);
}

.example-search:hover {
background-color: var(--highlight-dark);
color: white;
}

body.black-mode .example-search:hover {
background-color: var(--highlight-black);
}

body.eye-mode .example-search:hover {
background-color: var(--highlight-eye);
}

.highlight {
background-color: rgba(29, 161, 242, 0.2);
padding: 0 2px;
border-radius: 3px;
}

body.black-mode .highlight {
background-color: rgba(74, 158, 255, 0.2);
}

body.eye-mode .highlight {
background-color: rgba(123, 167, 217, 0.2);
}

/* Podcasts Section */
#podcasts {
background-color: var(--secondary-dark);
border-radius: 12px;
padding: 20px;
margin-bottom: 20px;
display: none;
border: 1px solid var(--accent-dark);
}

body.day-mode #podcasts {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
}

body.black-mode #podcasts {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
}

body.eye-mode #podcasts {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
}

#podcasts h2 {
font-size: 1.5rem;
margin-bottom: 20px;
padding-bottom: 10px;
border-bottom: 1px solid var(--accent-dark);
display: flex;
align-items: center;
gap: 10px;
}

body.day-mode #podcasts h2 {
border-bottom: 1px solid var(--accent-light);
}

body.black-mode #podcasts h2 {
border-bottom: 1px solid var(--accent-black);
}

body.eye-mode #podcasts h2 {
border-bottom: 1px solid var(--accent-eye);
}

#podcasts h2 i {
color: var(--highlight-dark);
}

body.black-mode #podcasts h2 i {
color: var(--highlight-black);
}

body.eye-mode #podcasts h2 i {
color: var(--highlight-eye);
}

.podcast-container {
margin-bottom: 30px;
width: 100%;
}

.podcast-container iframe {
width: 100%;
margin-bottom: 20px;
box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

body.day-mode .podcast-container iframe {
box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

body.black-mode .podcast-container iframe {
box-shadow: 0 4px 12px rgba(255, 255, 255, 0.05);
}

body.eye-mode .podcast-container iframe {
box-shadow: 0 4px 12px rgba(255, 255, 255, 0.03);
}

/* Settings Section */
#settings {
background-color: var(--secondary-dark);
border-radius: 12px;
padding: 20px;
margin-bottom: 20px;
display: none;
border: 1px solid var(--accent-dark);
}

body.day-mode #settings {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
}

body.black-mode #settings {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
}

body.eye-mode #settings {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
}

#settings h2 {
font-size: 1.5rem;
margin-bottom: 20px;
padding-bottom: 10px;
border-bottom: 1px solid var(--accent-dark);
display: flex;
align-items: center;
gap: 10px;
}

body.day-mode #settings h2 {
border-bottom: 1px solid var(--accent-light);
}

body.black-mode #settings h2 {
border-bottom: 1px solid var(--accent-black);
}

body.eye-mode #settings h2 {
border-bottom: 1px solid var(--accent-eye);
}

#settings h2 i {
color: var(--highlight-dark);
}

body.black-mode #settings h2 i {
color: var(--highlight-black);
}

body.eye-mode #settings h2 i {
color: var(--highlight-eye);
}

.settings-section {
margin-bottom: 30px;
}

.settings-section h3 {
font-size: 1.2rem;
margin-bottom: 15px;
font-weight: 500;
}

.setting-item {
display: flex;
justify-content: space-between;
align-items: center;
padding: 15px;
background-color: var(--accent-dark);
border-radius: 10px;
margin-bottom: 15px;
transition: all 0.2s var(--transition-function);
}

body.day-mode .setting-item {
background-color: var(--accent-light);
}

body.black-mode .setting-item {
background-color: var(--accent-black);
}

body.eye-mode .setting-item {
background-color: var(--accent-eye);
}

.setting-item:hover {
transform: translateY(-2px);
box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

body.day-mode .setting-item:hover {
box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
}

body.black-mode .setting-item:hover {
box-shadow: 0 4px 8px rgba(255, 255, 255, 0.05);
}

body.eye-mode .setting-item:hover {
box-shadow: 0 4px 8px rgba(255, 255, 255, 0.03);
}

.setting-label {
display: flex;
flex-direction: column;
}

.setting-label span:first-child {
font-weight: 500;
margin-bottom: 5px;
}

.setting-label span:last-child {
font-size: 0.85rem;
opacity: 0.7;
}

.theme-mode-selection {
display: flex;
gap: 10px;
flex-wrap: wrap;
}

.theme-option {
padding: 10px 15px;
border: 2px solid var(--accent-dark);
border-radius: 10px;
cursor: pointer;
transition: all 0.2s var(--transition-function);
background-color: var(--secondary-dark);
color: var(--text-dark);
font-size: 0.9rem;
display: flex;
align-items: center;
gap: 8px;
min-width: 120px;
justify-content: center;
}

body.day-mode .theme-option {
border-color: var(--accent-light);
background-color: var(--secondary-light);
color: var(--text-light);
}

body.black-mode .theme-option {
border-color: var(--accent-black);
background-color: var(--secondary-black);
color: var(--text-black);
}

body.eye-mode .theme-option {
border-color: var(--accent-eye);
background-color: var(--secondary-eye);
color: var(--text-eye);
}

.theme-option.active {
border-color: var(--highlight-dark);
background-color: var(--highlight-dark);
color: white;
}

body.black-mode .theme-option.active {
border-color: var(--highlight-black);
background-color: var(--highlight-black);
}

body.eye-mode .theme-option.active {
border-color: var(--highlight-eye);
background-color: var(--highlight-eye);
}

.theme-option:hover {
transform: translateY(-2px);
border-color: var(--highlight-dark);
}

body.black-mode .theme-option:hover {
border-color: var(--highlight-black);
}

body.eye-mode .theme-option:hover {
border-color: var(--highlight-eye);
}

.toggle-switch {
position: relative;
display: inline-block;
width: 50px;
height: 24px;
}

.toggle-switch input {
opacity: 0;
width: 0;
height: 0;
}

.toggle-slider {
position: absolute;
cursor: pointer;
top: 0;
left: 0;
right: 0;
bottom: 0;
background-color: var(--accent-dark);
transition: .4s;
border-radius: 24px;
}

body.day-mode .toggle-slider {
background-color: #ccc;
}

body.black-mode .toggle-slider {
background-color: var(--accent-black);
}

body.eye-mode .toggle-slider {
background-color: var(--accent-eye);
}

.toggle-slider:before {
position: absolute;
content: "";
height: 18px;
width: 18px;
left: 3px;
bottom: 3px;
background-color: white;
transition: .4s;
border-radius: 50%;
}

input:checked + .toggle-slider {
background-color: var(--highlight-dark);
}

body.black-mode input:checked + .toggle-slider {
background-color: var(--highlight-black);
}

body.eye-mode input:checked + .toggle-slider {
background-color: var(--highlight-eye);
}

input:checked + .toggle-slider:before {
transform: translateX(26px);
}

.color-options {
display: flex;
gap: 10px;
flex-wrap: wrap;
}

.color-option {
width: 30px;
height: 30px;
border-radius: 50%;
cursor: pointer;
transition: transform 0.2s var(--transition-function);
position: relative;
}

.color-option:hover {
transform: scale(1.1);
}

.color-option.active::after {
content: '\f00c';
font-family: 'Font Awesome 5 Free';
font-weight: 900;
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
color: white;
font-size: 14px;
text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
}

.font-size-control {
display: flex;
align-items: center;
gap: 15px;
}

.font-size-btn {
width: 36px;
height: 36px;
border-radius: 50%;
background-color: var(--accent-dark);
color: var(--text-dark);
border: none;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
font-size: 1.2rem;
transition: all 0.2s var(--transition-function);
}

body.day-mode .font-size-btn {
background-color: var(--accent-light);
color: var(--text-light);
}

body.black-mode .font-size-btn {
background-color: var(--accent-black);
color: var(--text-black);
}

body.eye-mode .font-size-btn {
background-color: var(--accent-eye);
color: var(--text-eye);
}

.font-size-btn:hover {
background-color: var(--highlight-dark);
color: white;
}

body.black-mode .font-size-btn:hover {
background-color: var(--highlight-black);
}

body.eye-mode .font-size-btn:hover {
background-color: var(--highlight-eye);
}

.font-size-value {
font-weight: 500;
min-width: 30px;
text-align: center;
}

.custom-select {
position: relative;
width: 100%;
}

.custom-select select {
width: 100%;
padding: 10px 15px;
border: 1px solid var(--accent-dark);
border-radius: 10px;
background-color: var(--secondary-dark);
color: var(--text-dark);
font-size: 0.95rem;
appearance: none;
background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
background-repeat: no-repeat;
background-position: right 15px center;
background-size: 16px;
transition: all 0.2s var(--transition-function);
}

body.day-mode .custom-select select {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
color: var(--text-light);
background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%230f1419' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
}

body.black-mode .custom-select select {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
color: var(--text-black);
background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23e0e0e0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
}

body.eye-mode .custom-select select {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
color: var(--text-eye);
background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23d4d4d4' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
}

.custom-select select:focus {
outline: none;
border-color: var(--highlight-dark);
box-shadow: none;
}

body.black-mode .custom-select select:focus {
border-color: var(--highlight-black);
}

body.eye-mode .custom-select select:focus {
border-color: var(--highlight-eye);
}

.range-slider {
width: 100%;
margin: 10px 0;
}

.range-slider input {
width: 100%;
height: 5px;
border-radius: 5px;
background: var(--accent-dark);
outline: none;
-webkit-appearance: none;
}

body.day-mode .range-slider input {
background: var(--accent-light);
}

body.black-mode .range-slider input {
background: var(--accent-black);
}

body.eye-mode .range-slider input {
background: var(--accent-eye);
}

.range-slider input::-webkit-slider-thumb {
-webkit-appearance: none;
appearance: none;
width: 18px;
height: 18px;
border-radius: 50%;
background: var(--highlight-dark);
cursor: pointer;
}

body.black-mode .range-slider input::-webkit-slider-thumb {
background: var(--highlight-black);
}

body.eye-mode .range-slider input::-webkit-slider-thumb {
background: var(--highlight-eye);
}

.range-slider input::-moz-range-thumb {
width: 18px;
height: 18px;
border-radius: 50%;
background: var(--highlight-dark);
cursor: pointer;
border: none;
}

body.black-mode .range-slider input::-moz-range-thumb {
background: var(--highlight-black);
}

body.eye-mode .range-slider input::-moz-range-thumb {
background: var(--highlight-eye);
}

.settings-btn {
padding: 12px 20px;
border: none;
border-radius: 10px;
background-color: var(--highlight-dark);
color: white;
font-size: 0.95rem;
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
gap: 8px;
transition: background-color 0.2s var(--transition-function);
width: 100%;
margin-top: 10px;
}

body.black-mode .settings-btn {
background-color: var(--highlight-black);
}

body.eye-mode .settings-btn {
background-color: var(--highlight-eye);
}

.settings-btn:hover {
background-color: #1a91da;
}

body.black-mode .settings-btn:hover {
background-color: #3a8eff;
}

body.eye-mode .settings-btn:hover {
background-color: #6b9bd4;
}

footer {
padding: 15px 20px;
text-align: center;
font-size: 0.9rem;
color: var(--text-dark);
opacity: 0.8;
border-top: 1px solid var(--accent-dark);
margin-top: auto;
transition: all 0.3s var(--transition-function);
}

body.day-mode footer {
color: var(--text-light);
border-top: 1px solid var(--accent-light);
}

body.black-mode footer {
color: var(--text-black);
border-top: 1px solid var(--accent-black);
}

body.eye-mode footer {
color: var(--text-eye);
border-top: 1px solid var(--accent-eye);
}

@keyframes loadingProgress {
0% { width: 0%; }
50% { width: 100%; }
100% { width: 0%; }
}

.bottom-nav {
position: fixed;
bottom: 20px;
left: 50%;
transform: translateX(-50%);
background-color: var(--secondary-dark);
border-radius: 30px;
padding: 5px;
display: flex;
align-items: center;
justify-content: center;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
z-index: 50;
display: none;
}

body.day-mode .bottom-nav {
background-color: var(--secondary-light);
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

body.black-mode .bottom-nav {
background-color: var(--secondary-black);
box-shadow: 0 5px 15px rgba(255, 255, 255, 0.1);
}

body.eye-mode .bottom-nav {
background-color: var(--secondary-eye);
box-shadow: 0 5px 15px rgba(255, 255, 255, 0.05);
}

.bottom-nav-item {
display: flex;
align-items: center;
justify-content: center;
width: 50px;
height: 50px;
border-radius: 25px;
cursor: pointer;
transition: all 0.3s ease;
}

.bottom-nav-item:hover {
background-color: var(--accent-dark);
}

body.day-mode .bottom-nav-item:hover {
background-color: var(--accent-light);
}

body.black-mode .bottom-nav-item:hover {
background-color: var(--accent-black);
}

body.eye-mode .bottom-nav-item:hover {
background-color: var(--accent-eye);
}

.bottom-nav-item.active {
background-color: var(--highlight-dark);
color: white;
}

body.black-mode .bottom-nav-item.active {
background-color: var(--highlight-black);
}

body.eye-mode .bottom-nav-item.active {
background-color: var(--highlight-eye);
}

.bottom-nav-item i {
font-size: 1.2rem;
}

.home-btn {
width: 60px;
height: 60px;
border-radius: 30px;
background-color: var(--highlight-dark);
color: white;
display: flex;
align-items: center;
justify-content: center;
font-size: 1.5rem;
margin: 0 5px;
box-shadow: none;
transition: all 0.3s ease;
}

body.black-mode .home-btn {
background-color: var(--highlight-black);
}

body.eye-mode .home-btn {
background-color: var(--highlight-eye);
}

.home-btn:hover {
transform: translateY(-5px);
box-shadow: none;
}

@media (max-width: 768px) {
.sidebar {
display: none;
}

body:has(#search-page.active) .sidebar {
display: flex;
width: 50px;
z-index: 101;
}

body:has(#search-page.active) #search-page {
left: 50px;
width: calc(100% - 50px);
}

.main-content {
margin-left: 0;
}

.content {
padding: 15px;
padding-bottom: 80px;
}

.search-page-container {
flex-direction: column;
}

.search-page-sidebar {
width: 100%;
position: static;
margin-bottom: 20px;
}

.setting-item {
flex-direction: column;
align-items: flex-start;
gap: 15px;
}

.setting-item .setting-label {
margin-bottom: 10px;
}

.color-options {
justify-content: center;
}

.theme-mode-selection {
justify-content: center;
}

.bottom-nav {
display: flex;
}

#search-page {
left: 0;
width: 100%;
}

.author-sort-content {
width: 95%;
max-height: 90vh;
padding: 20px;
}

.author-sort-title {
font-size: 1.1rem;
}

.author-item {
padding: 12px;
}

.sort-actions {
flex-direction: column;
gap: 8px;
}

.sort-btn {
width: 100%;
}
}

@media (max-width: 480px) {
.header h1 {
font-size: 1rem;
}

.controls-row {
flex-direction: column;
}

#search, #author-select, #show-saved {
font-size: 0.9rem;
padding: 10px 15px;
}

.surah h2 {
font-size: 1rem;
}

#verse-panel h3, #saved-verses h2, #verse-detail-panel h3, #podcasts h2, #settings h2 {
font-size: 1.3rem;
}

.verse {
font-size: 0.9rem;
}

#verse-detail-panel .selected-translation {
font-size: 1rem;
padding: 15px;
}

#verse-detail-panel .other-translations div {
font-size: 0.9rem;
padding: 12px;
}

.settings-section h3 {
font-size: 1.1rem;
}
}

@media (min-width: 769px) {
.bottom-nav {
display: none;
}
}

@media (max-width: 768px) {
.bottom-nav {
display: flex;
}
}

.verse-link {
color: inherit;
text-decoration: none;
display: inline-block;
margin-right: 5px;
}

.verse-link:hover {
text-decoration: underline;
color: var(--highlight-dark);
}

body.black-mode .verse-link:hover {
color: var(--highlight-black);
}

body.eye-mode .verse-link:hover {
color: var(--highlight-eye);
}

.copy-url-btn {
background: none;
border: none;
color: var(--text-dark);
font-size: 1rem;
cursor: pointer;
padding: 8px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: background-color 0.2s var(--transition-function);
}

body.day-mode .copy-url-btn {
color: var(--text-light);
}

body.black-mode .copy-url-btn {
color: var(--text-black);
}

body.eye-mode .copy-url-btn {
color: var(--text-eye);
}

.copy-url-btn:hover {
background-color: var(--accent-dark);
color: var(--highlight-dark);
}

body.day-mode .copy-url-btn:hover {
background-color: var(--accent-light);
}

body.black-mode .copy-url-btn:hover {
background-color: var(--accent-black);
color: var(--highlight-black);
}

body.eye-mode .copy-url-btn:hover {
background-color: var(--accent-eye);
color: var(--highlight-eye);
}

.arabic-text {
font-family: 'Amiri', 'Scheherazade New', serif;
direction: rtl;
text-align: right;
font-size: 1.5em;
line-height: 1.8;
margin-bottom: 15px;
padding: 15px;
background-color: var(--accent-dark);
border-radius: 12px;
border: 1px solid rgba(255, 255, 255, 0.1);
}

body.day-mode .arabic-text {
background-color: var(--accent-light);
border: 1px solid rgba(0, 0, 0, 0.1);
}

body.black-mode .arabic-text {
background-color: var(--accent-black);
border: 1px solid rgba(255, 255, 255, 0.05);
}

body.eye-mode .arabic-text {
background-color: var(--accent-eye);
border: 1px solid rgba(255, 255, 255, 0.03);
}

.word-analysis {
margin-top: 20px;
border-top: 1px solid var(--accent-dark);
padding-top: 20px;
}

body.day-mode .word-analysis {
border-top: 1px solid var(--accent-light);
}

body.black-mode .word-analysis {
border-top: 1px solid var(--accent-black);
}

body.eye-mode .word-analysis {
border-top: 1px solid var(--accent-eye);
}

.word-analysis h4 {
font-size: 1.1rem;
margin-bottom: 15px;
color: var(--highlight-dark);
}

body.black-mode .word-analysis h4 {
color: var(--highlight-black);
}

body.eye-mode .word-analysis h4 {
color: var(--highlight-eye);
}

.word-list {
display: flex;
flex-wrap: wrap;
gap: 10px;
margin-bottom: 20px;
}

.word-item {
background-color: var(--secondary-dark);
border-radius: 8px;
padding: 10px;
border: 1px solid var(--accent-dark);
cursor: pointer;
transition: all 0.2s var(--transition-function);
min-width: 100px;
text-align: center;
}

body.day-mode .word-item {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
}

body.black-mode .word-item {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
}

body.eye-mode .word-item {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
}

.word-item:hover {
transform: translateY(-3px);
box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
border-color: var(--highlight-dark);
}

body.day-mode .word-item:hover {
box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
}

body.black-mode .word-item:hover {
box-shadow: 0 4px 8px rgba(255, 255, 255, 0.05);
border-color: var(--highlight-black);
}

body.eye-mode .word-item:hover {
box-shadow: 0 4px 8px rgba(255, 255, 255, 0.03);
border-color: var(--highlight-eye);
}

.word-arabic {
font-family: 'Amiri', 'Scheherazade New', serif;
font-size: 1.3em;
margin-bottom: 5px;
direction: rtl;
}

.word-translation {
font-size: 0.85rem;
color: var(--text-dark);
opacity: 0.9;
}

body.day-mode .word-translation {
color: var(--text-light);
}

body.black-mode .word-translation {
color: var(--text-black);
}

body.eye-mode .word-translation {
color: var(--text-eye);
}

.word-detail {
display: none;
background-color: var(--accent-dark);
border-radius: 10px;
padding: 15px;
margin-top: 10px;
border: 1px solid rgba(255, 255, 255, 0.1);
}

body.day-mode .word-detail {
background-color: var(--accent-light);
border: 1px solid rgba(0, 0, 0, 0.1);
}

body.black-mode .word-detail {
background-color: var(--accent-black);
border: 1px solid rgba(255, 255, 255, 0.05);
}

body.eye-mode .word-detail {
background-color: var(--accent-eye);
border: 1px solid rgba(255, 255, 255, 0.03);
}

.word-detail.active {
display: block;
}

.word-detail-row {
display: flex;
margin-bottom: 8px;
align-items: flex-start;
}

.word-detail-label {
font-weight: 500;
min-width: 100px;
color: var(--highlight-dark);
}

body.black-mode .word-detail-label {
color: var(--highlight-black);
}

body.eye-mode .word-detail-label {
color: var(--highlight-eye);
}

.word-detail-value {
flex: 1;
}

.root-info {
margin-top: 10px;
padding-top: 10px;
border-top: 1px solid rgba(255, 255, 255, 0.1);
}

body.day-mode .root-info {
border-top: 1px solid rgba(0, 0, 0, 0.1);
}

body.black-mode .root-info {
border-top: 1px solid rgba(255, 255, 255, 0.05);
}

body.eye-mode .root-info {
border-top: 1px solid rgba(255, 255, 255, 0.03);
}

.transcription {
margin-bottom: 20px;
padding: 15px;
background-color: var(--secondary-dark);
border-radius: 12px;
border: 1px solid var(--accent-dark);
font-style: italic;
}

body.day-mode .transcription {
background-color: var(--secondary-light);
border: 1px solid var(--accent-light);
}

body.black-mode .transcription {
background-color: var(--secondary-black);
border: 1px solid var(--accent-black);
}

body.eye-mode .transcription {
background-color: var(--secondary-eye);
border: 1px solid var(--accent-eye);
}

.transcription-label {
font-weight: 500;
color: var(--highlight-dark);
margin-right: 5px;
}

body.black-mode .transcription-label {
color: var(--highlight-black);
}

body.eye-mode .transcription-label {
color: var(--highlight-eye);
}

.other-occurrences {
margin-top: 15px;
padding-top: 15px;
border-top: 1px solid rgba(255, 255, 255, 0.1);
}

body.day-mode .other-occurrences {
border-top: 1px solid rgba(0, 0, 0, 0.1);
}

body.black-mode .other-occurrences {
border-top: 1px solid rgba(255, 255, 255, 0.05);
}

body.eye-mode .other-occurrences {
border-top: 1px solid rgba(255, 255, 255, 0.03);
}

.occurrences-title {
font-size: 1.1rem;
margin-bottom: 10px;
color: var(--highlight-dark);
}

body.black-mode .occurrences-title {
color: var(--highlight-black);
}

body.eye-mode .occurrences-title {
color: var(--highlight-eye);
}

.word-occurrences {
display: flex;
flex-direction: column;
gap: 8px;
max-height: 200px;
overflow-y: auto;
}

.occurrence-item {
padding: 8px 12px;
background-color: var(--accent-dark);
border-radius: 8px;
transition: all 0.2s var(--transition-function);
}

body.day-mode .occurrence-item {
background-color: var(--accent-light);
}

body.black-mode .occurrence-item {
background-color: var(--accent-black);
}

body.eye-mode .occurrence-item {
background-color: var(--accent-eye);
}

.occurrence-item:hover {
background-color: var(--highlight-dark);
color: white;
}

body.black-mode .occurrence-item:hover {
background-color: var(--highlight-black);
}

body.eye-mode .occurrence-item:hover {
background-color: var(--highlight-eye);
}

.occurrence-link {
color: inherit;
text-decoration: none;
display: block;
width: 100%;
}

.loading-occurrences, .no-occurrences, .more-occurrences {
padding: 8px;
text-align: center;
font-style: italic;
opacity: 0.8;
}

.more-occurrences {
font-size: 0.9rem;
color: var(--highlight-dark);
}

body.black-mode .more-occurrences {
color: var(--highlight-black);
}

body.eye-mode .more-occurrences {
color: var(--highlight-eye);
}

.verse-section {
margin-bottom: 5px;
}

#main-search-results {
margin-top: 20px;
display: none;
}

#main-search-results.active {
display: block;
}

.verse-number-bg {
display: inline-block;
background-color: rgba(29, 161, 242, 0.15);
color: var(--highlight-dark);
font-weight: bold;
padding: 2px 6px;
border-radius: 4px;
margin-right: 8px;
min-width: 30px;
text-align: center;
}

body.day-mode .verse-number-bg {
background-color: rgba(29, 161, 242, 0.1);
}

body.black-mode .verse-number-bg {
background-color: rgba(74, 158, 255, 0.15);
color: var(--highlight-black);
}

body.eye-mode .verse-number-bg {
background-color: rgba(123, 167, 217, 0.15);
color: var(--highlight-eye);
}

#verse-detail-panel {
scroll-behavior: smooth;
}

#verse-detail-panel .verse-content-container {
scroll-behavior: smooth;
}

html {
scroll-behavior: smooth;
}

.swipe-indicator {
position: fixed;
top: 50%;
transform: translateY(-50%);
background-color: rgba(29, 161, 242, 0.8);
color: white;
padding: 10px 15px;
border-radius: 25px;
font-size: 0.9rem;
z-index: 1000;
opacity: 0;
transition: opacity 0.3s ease;
pointer-events: none;
}

body.black-mode .swipe-indicator {
background-color: rgba(74, 158, 255, 0.8);
}

body.eye-mode .swipe-indicator {
background-color: rgba(123, 167, 217, 0.8);
}

.swipe-indicator.left {
left: 20px;
}

.swipe-indicator.right {
right: 20px;
}

.swipe-indicator.show {
opacity: 1;
}
</style>
</head>
<body>
<!-- Desktop Sidebar -->
<div class="sidebar">
<img src="sdc1.PNG" alt="Logo" class="sidebar-logo" />
<nav class="sidebar-nav">
<div class="nav-item active" id="home-nav-desktop">
<i class="fas fa-home"></i>
</div>
<div class="nav-item" id="search-nav-desktop">
<i class="fas fa-search"></i>
</div>
<div class="nav-item" id="saved-nav-desktop">
<i class="fas fa-bookmark"></i>
</div>
<div class="nav-item" id="meal-writers-nav-desktop">
<i class="fas fa-users"></i>
</div>
<div class="nav-item" id="podcasts-nav-desktop">
<i class="fas fa-podcast"></i>
</div>
<div class="nav-item" id="settings-nav-desktop">
<i class="fas fa-cog"></i>
</div>
</nav>
</div>

<div class="main-content">
<header class="header">
<h1>SADECE KURAN</h1>
<div class="header-actions">
<button id="theme-toggle"><i class="fas fa-moon"></i></button>
</div>
</header>

<div class="content">
<div class="controls">
<div class="search-container">
<input type="text" id="search" placeholder="Sure, ayet veya kelime ara..." />
<i class="fas fa-search search-icon"></i>
</div>
<div class="controls-row">
<select id="author-select">
<option value="">Meal Seçin</option>
</select>
<button id="show-saved"><i class="fas fa-bookmark"></i> Kaydedilenler</button>
</div>
<div id="loading-bar">
<div class="progress"></div>
</div>
</div>

<div id="main-search-results"></div>

<div id="surahs"></div>

<div id="verse-panel">
<div class="verse-panel-header">
<div class="verse-panel-title">
<button id="close-panel"><i class="fas fa-arrow-left"></i></button>
<span id="panel-title"></span>
</div>
<div class="audio-controls">
<button id="surah-audio-btn" class="audio-btn" title="Sureyi dinle">
<i class="fas fa-play"></i>
</button>
</div>
</div>
<div id="verses"></div>
</div>

<div id="verse-detail-panel">
<h3>
<button id="back-btn" class="back-btn"><i class="fas fa-arrow-left"></i></button>
<span id="verse-detail-title"></span>
</h3>

<div class="verse-content-container">
<div class="verse-left-sidebar">
<div class="sidebar-title">
DİĞER MEALLER
<button class="sort-authors-btn" id="sort-authors-btn">
  <i class="fas fa-sort"></i> Sırala
</button>
</div>
<div id="other-translations" class="other-translations"></div>
</div>

<div class="verse-main-content">
<div class="verse-section">
<div id="selected-translation" class="selected-translation"></div>
</div>

<div class="verse-section">
<div id="arabic-text" class="arabic-text"></div>
</div>

<div class="verse-section">
<div class="transcription">
<span class="transcription-label">T.:</span>
<span id="transcription-tr"></span>
</div>
</div>

<div class="verse-navigation-buttons">
<div class="verse-navigation-audio">
<button id="verse-audio-btn" class="audio-btn" title="Ayeti dinle">
  <i class="fas fa-play"></i>
</button>
</div>
<div class="verse-detail-actions">
<button id="verse-detail-save-btn" class="verse-detail-save-btn" title="Kaydet">
  <i class="fas fa-bookmark"></i> 
</button>
<button id="verse-detail-share-btn" class="verse-detail-share-btn" title="Paylaş">
  <i class="fas fa-share-alt"></i> 
</button>
</div>
<button id="prev-verse-btn" class="nav-btn"><i class="fas fa-chevron-left"></i> </button>
<button id="next-verse-btn" class="nav-btn"> <i class="fas fa-chevron-right"></i></button>
</div>
</div>

<div class="verse-right-sidebar">
<h4 class="sidebar-title">KELİME ANALİZİ</h4>
<div class="word-analysis">
<div id="word-list" class="word-list"></div>
<div id="word-detail" class="word-detail"></div>
</div>
</div>
</div>

<div class="tab-container">
<div class="tab-buttons">
<div class="tab-header">
<button class="tab-button active" data-tab="other-translations">
MEALLER
</button>
<button class="sort-authors-btn" id="sort-authors-btn-mobile">
<i class="fas fa-sort"></i>
</button>
</div>
<button class="tab-button" data-tab="word-analysis">KELİME ANALİZİ</button>
</div>

<div class="tab-content active" id="other-translations-tab">
<div id="other-translations-mobile" class="other-translations"></div>
</div>

<div class="tab-content" id="word-analysis-tab">
<div class="word-analysis">
<div id="word-list-mobile" class="word-list"></div>
<div id="word-detail-mobile" class="word-detail"></div>
</div>
</div>
</div>
</div>

<div class="author-sort-panel" id="author-sort-panel">
<div class="author-sort-content">
<div class="author-sort-header">
<h3 class="author-sort-title">Meal Yazarları Sıralaması</h3>
<button class="close-sort-panel" id="close-sort-panel">
<i class="fas fa-times"></i>
</button>
</div>

<div class="author-list" id="author-list">
</div>

<div class="sort-actions">
<button class="sort-btn reset-sort-btn" id="reset-sort-btn">
<i class="fas fa-undo"></i> Sıfırla
</button>
<button class="sort-btn save-sort-btn" id="save-sort-btn">
<i class="fas fa-save"></i> Kaydet
</button>
</div>
</div>
</div>

<div id="saved-verses">
<h2><i class="fas fa-bookmark"></i> Kaydedilen Ayetler</h2>
<div id="saved-list"></div>
<button id="back-to-surahs"><i class="fas fa-arrow-left"></i> Surelere Dön</button>
</div>

<!-- Note Modal -->
<div class="note-modal" id="note-modal">
<div class="note-modal-content">
<div class="note-modal-header">
<h3 class="note-modal-title">Not Ekle/Düzenle</h3>
<button class="close-note-modal" id="close-note-modal">
<i class="fas fa-times"></i>
</button>
</div>

<div class="note-verse-preview" id="note-verse-preview">
<div class="note-verse-text" id="note-verse-text"></div>
<div class="note-verse-ref" id="note-verse-ref"></div>
</div>

<textarea class="note-textarea" id="note-textarea" placeholder="Notunuzu buraya yazın..."></textarea>

<div class="note-actions">
<button class="note-btn cancel-note-btn" id="cancel-note-btn">
<i class="fas fa-times"></i> İptal
</button>
<button class="note-btn save-note-btn" id="save-note-btn">
<i class="fas fa-save"></i> Kaydet
</button>
</div>
</div>
</div>

<div id="podcasts">
<h2><i class="fas fa-podcast"></i> Podcastler</h2>

<div class="podcast-container">
<iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/3RRKc1JEyzLSkBjfut5EwH?utm_source=generator" width="100%" height="156" title="Sadece Kuran Podcast" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>

</div>
</div>

<div id="settings">
<h2><i class="fas fa-cog"></i> Ayarlar</h2>

<div class="settings-section">
<h3>Görünüm</h3>

<div class="setting-item">
<div class="setting-label">
<span>Tema Modu</span>
<span>Karanlık, tam siyah, göz dostu veya açık tema seçin</span>
</div>
<div class="theme-mode-selection">
<div class="theme-option" data-theme="dark">
<i class="fas fa-moon"></i> Karanlık
</div>
<div class="theme-option" data-theme="black">
<i class="fas fa-circle"></i> Tam Siyah
</div>
<div class="theme-option" data-theme="eye">
<i class="fas fa-eye"></i> Göz Dostu
</div>
<div class="theme-option" data-theme="day">
<i class="fas fa-sun"></i> Açık
</div>
</div>
</div>

<div class="setting-item">
<div class="setting-label">
<span>Tema Rengi</span>
<span>Uygulamanın vurgu rengini seçin</span>
</div>
<div class="color-options">
<div class="color-option active" style="background-color: #1da1f2;" data-color="#1da1f2"></div>
<div class="color-option" style="background-color: #4caf50;" data-color="#4caf50"></div>
<div class="color-option" style="background-color: #f44336;" data-color="#f44336"></div>
<div class="color-option" style="background-color: #9c27b0;" data-color="#9c27b0"></div>
<div class="color-option" style="background-color: #ff9800;" data-color="#ff9800"></div>
<div class="color-option" style="background-color: #7b7675;" data-color="#7b7675"></div>
</div>
</div>

<div class="setting-item">
<div class="setting-label">
<span>Yazı Boyutu</span>
<span>Ayet metinlerinin boyutunu ayarlayın</span>
</div>
<div class="font-size-control">
<button class="font-size-btn" id="decrease-font"><i class="fas fa-minus"></i></button>
<span class="font-size-value" id="font-size-value">100%</span>
<button class="font-size-btn" id="increase-font"><i class="fas fa-plus"></i></button>
</div>
</div>

<div class="setting-item">
<div class="setting-label">
<span>Ayet Numarası Stili</span>
<span>Ayet numaralarının görünümünü seçin</span>
</div>
<div class="custom-select">
<select id="verse-number-style">
<option value="default">Varsayılan</option>
<option value="bg" selected>Soluk Arka Plan</option>
<option value="bold">Kalın ve Renkli</option>
<option value="underline">Altı Çizgili</option>
</select>
</div>
</div>

<div class="setting-item">
<div class="setting-label">
<span>Arapça Metin Görünümü</span>
<span>Arapça metin gösterim tercihini seçin</span>
</div>
<div class="custom-select">
<select id="arabic-display-mode">
<option value="always">Her Zaman Göster</option>
<option value="tab" selected>Sekme Olarak Göster</option>
<option value="never">Gösterme</option>
</select>
</div>
</div>
</div>

<div class="settings-section">
<h3>Okuma Ayarları</h3>

<div class="setting-item">
<div class="setting-label">
<span>Varsayılan Meal</span>
<span>Tercih ettiğiniz meali seçin</span>
</div>
<div class="custom-select">
<select id="default-author">
<option value="Mehmet Okuyan">Mehmet Okuyan</option>
<option value="Mustafa İslamoğlu">Mustafa İslamoğlu</option>
<option value="Yaşar Nuri Öztürk">Yaşar Nuri Öztürk</option>
<option value="Edip Yüksel">Edip Yüksel</option>
<option value="Diyanet Vakfı">Diyanet Vakfı</option>
</select>
</div>
</div>

<div class="setting-item">
<div class="setting-label">
<span>Otomatik Kaydırma</span>
<span>Uzun surelerde otomatik kaydırma</span>
</div>
<label class="toggle-switch">
<input type="checkbox" id="auto-scroll-toggle">
<span class="toggle-slider"></span>
</label>
</div>

<div class="setting-item">
<div class="setting-label">
<span>Kaydırma Hızı</span>
<span>Otomatik kaydırma hızını ayarlayın</span>
</div>
<div class="range-slider">
<input type="range" min="1" max="10" value="5" id="scroll-speed">
</div>
</div>

<div class="setting-item">
<div class="setting-label">
<span>Kelime Analizi</span>
<span>Ayet detayında kelime analizi göster</span>
</div>
<label class="toggle-switch">
<input type="checkbox" id="word-analysis-toggle" checked>
<span class="toggle-slider"></span>
</label>
</div>
</div>

<div class="settings-section">
<h3>Bildirimler</h3>

<div class="setting-item">
<div class="setting-label">
<span>Günlük Ayet Bildirimleri</span>
<span>Her gün rastgele bir ayet bildirimi alın</span>
</div>
<label class="toggle-switch">
<input type="checkbox" id="daily-verse-toggle">
<span class="toggle-slider"></span>
</label>
</div>

<div class="setting-item">
<div class="setting-label">
<span>Bildirim Zamanı</span>
<span>Günlük ayet bildiriminin zamanını seçin</span>
</div>
<div class="custom-select">
<select id="notification-time">
  <option value="morning">Sabah (08:00)</option>
  <option value="noon">Öğle (12:00)</option>
  <option value="evening">Akşam (18:00)</option>
  <option value="night">Gece (21:00)</option>
</select>
</div>
</div>
</div>

<div class="settings-section">
<h3>Veri ve Gizlilik</h3>

<div class="setting-item">
<div class="setting-label">
<span>Çevrimdışı Kullanım</span>
<span>İnternetsiz kullanım için verileri kaydet</span>
</div>
<label class="toggle-switch">
<input type="checkbox" id="offline-toggle" checked>
<span class="toggle-slider"></span>
</label>
</div>

<div class="setting-item">
<div class="setting-label">
<span>Arama Geçmişi</span>
<span>Arama geçmişinizi kaydet</span>
</div>
<label class="toggle-switch">
<input type="checkbox" id="search-history-toggle" checked>
<span class="toggle-slider"></span>
</label>
</div>

<button class="settings-btn" id="clear-data-btn">
<i class="fas fa-trash-alt"></i> Tüm Verileri Temizle
</button>
</div>

<div class="settings-section">
<h3>Hakkında</h3>

<button class="settings-btn" id="app-btn">
<svg class="button-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
<path d="M6 18c0 .55.45 1 1 1h1v3.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5V19h2v3.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5V19h1c.55 0 1-.45 1-1V8H6v10zM3.5 8C2.67 8 2 8.67 2 9.5v7c0 .83.67 1.5 1.5 1.5S5 17.33 5 16.5v-7C5 8.67 4.33 8 3.5 8zm17 0c-.83 0-1.5.67-1.5 1.5v7c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5v-7c0-.83-.67-1.5-1.5-1.5zm-4.97-5.84l1.3-1.3c.2-.2.2-.51 0-.71-.2-.2-.51-.2-.71 0l-1.48 1.48C13.85 1.23 12.95 1 12 1c-.96 0-1.86.23-2.66.63L7.86 3.11c-.2.2-.2.51 0 .71.2.2.51.2.71 0l1.3-1.3C10.66 2.19 11.32 2 12 2c.68 0 1.34.19 1.91.54zM12 4c-4.42 0-8 3.58-8 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8z"/>
</svg> Mobil Uygulama İNDİR
</button>

<div class="setting-item">
<div class="setting-label">
<span>Uygulama Versiyonu</span>
<span>v1.3.0</span>
</div>
</div>

<button class="settings-btn" id="feedback-btn">
<i class="fas fa-comment-alt"></i> Geri Bildirim Gönder
</button>
</div>
</div>
</div>

<footer>
<p>© 2025 THE LENG | SADECE KURAN</p>
</footer>
</div>

<div id="search-page">
<div class="search-page-header">
<button class="search-page-back"><i class="fas fa-arrow-left"></i></button>
<h2>Arama</h2>
</div>

<div class="search-page-container">
<div class="search-page-main">
<div class="search-page-input-container">
<input type="text" id="search-page-input" placeholder="Sure, ayet veya kelime ara..." autofocus />
<i class="fas fa-search search-page-icon"></i>
</div>
<div id="search-results"></div>
</div>

<div class="search-page-sidebar">
<h3>Örnek Aramalar</h3>
<div class="example-searches">
<div class="example-search"><i class="fas fa-hashtag"></i> islam</div>
<div class="example-search"><i class="fas fa-hashtag"></i> iman</div>
<div class="example-search"><i class="fas fa-hashtag"></i> rahmet</div>
<div class="example-search"><i class="fas fa-hashtag"></i> tevhid</div>
<div class="example-search"><i class="fas fa-hashtag"></i> sabır</div>
<div class="example-search"><i class="fas fa-hashtag"></i> şükür</div>
<div class="example-search"><i class="fas fa-hashtag"></i> dua</div>
<div class="example-search"><i class="fas fa-hashtag"></i> namaz</div>
</div>
</div>
</div>
</div>

<div class="bottom-nav">
<div class="bottom-nav-item active" id="home-nav">
<i class="fas fa-home"></i>
</div>
<div class="bottom-nav-item" id="search-nav">
<i class="fas fa-search"></i>
</div>
<div class="home-btn" id="home-btn">
<i class="fas fa-book-open"></i>
</div>
<div class="bottom-nav-item" id="saved-nav">
<i class="fas fa-bookmark"></i>
</div>
<div class="bottom-nav-item" id="settings-nav">
<i class="fas fa-cog"></i>
</div>
</div>

<div class="audio-player" id="audio-player">
<div class="audio-player-content">
<div class="audio-info">
<div class="audio-title" id="audio-title">Sure Adı</div>
<div class="audio-subtitle" id="audio-subtitle">Sesli Kuran</div>
</div>

<div class="audio-controls-main">
<button class="audio-control-btn" id="audio-prev-btn" title="Önceki Sure">
<i class="fas fa-step-backward"></i>
</button>
<button class="audio-control-btn audio-play-btn" id="audio-play-pause-btn" title="Oynat/Duraklat">
<i class="fas fa-play"></i>
</button>
<button class="audio-control-btn" id="audio-next-btn" title="Sonraki Sure">
<i class="fas fa-step-forward"></i>
</button>
</div>

<div class="audio-progress-container">
<div class="audio-progress" id="audio-progress">
<div class="audio-progress-bar" id="audio-progress-bar"></div>
</div>
<div class="audio-time">
<span id="audio-current-time">0:00</span>
<span id="audio-duration">0:00</span>
</div>
</div>

<div class="audio-volume">
<button class="audio-control-btn" id="audio-volume-btn" title="Ses">
<i class="fas fa-volume-up"></i>
</button>
<input type="range" class="volume-slider" id="volume-slider" min="0" max="100" value="100">
</div>

<button class="audio-control-btn audio-close-btn" id="audio-close-btn" title="Kapat">
<i class="fas fa-times"></i>
</button>
</div>
</div>

<div class="swipe-indicator left" id="swipe-left">
<i class="fas fa-chevron-left"></i>
</div>
<div class="swipe-indicator right" id="swipe-right">  <i class="fas fa-chevron-right"></i>
</div>

<audio id="audio-element" preload="none"></audio>

<script>
let quranData = [];
let jsonData = {};
let allSurahsData = null;
let selectedAuthor = "Mehmet Okuyan";
const totalSurahs = 114;
let verseNumberStyle = localStorage.getItem("verseNumberStyle") || "bg";
let arabicDisplayMode = localStorage.getItem("arabicDisplayMode") || "tab";
let showWordAnalysis = localStorage.getItem("showWordAnalysis") !== "false";
let dataLoaded = false;

let currentSurahIndex = 0;
let currentVerseIndex = 0;

let audioElement = null;
let audioPlayer = null;
let currentAudioSurah = null;
let isAudioPlaying = false;
let currentAudioTime = 0;
let audioDuration = 0;
let audioVolume = 1;

let touchStartX = 0;
let touchStartY = 0;
let touchEndX = 0;
let touchEndY = 0;
let isSwipeDetected = false;
let isInVerseDetailPanel = false;

let isScrolling = false;
let scrollTimeout = null;
let lastScrollY = 0;
let scrollThreshold = 10;

let longPressTimer = null;
let isLongPress = false;
let longPressTarget = null;

let authorOrder = JSON.parse(localStorage.getItem("authorOrder") || "[]");
let originalAuthorOrder = [];

let notificationPermissionGranted = false;

// Note editing variables
let currentEditingVerse = null;

// Current verse detail variables
let currentDetailVerse = null;

const surahNames = {
1: "Fatiha", 2: "Bakara", 3: "Al-i Imran", 4: "Nisa", 5: "Maide", 6: "Enam", 7: "Araf", 8: "Enfal", 9: "Tevbe", 10: "Yunus",
11: "Hud", 12: "Yusuf", 13: "Rad", 14: "Ibrahim", 15: "Hicr", 16: "Nahl", 17: "Isra", 18: "Kehf", 19: "Meryem", 20: "Ta-Ha",
21: "Enbiya", 22: "Hac", 23: "Muminun", 24: "Nur", 25: "Furkan", 26: "Suara", 27: "Neml", 28: "Kasas", 29: "Ankebut", 30: "Rum",
31: "Lokman", 32: "Secde", 33: "Ahzab", 34: "Sebe", 35: "Fatir", 36: "Yasin", 37: "Saffat", 38: "Sad", 39: "Zumer", 40: "Mumin",
41: "Fussilet", 42: "Sura", 43: "Zuhruf", 44: "Duhan", 45: "Casiye", 46: "Ahkaf", 47: "Muhammed", 48: "Fetih", 49: "Hucurat", 50: "Kaf",
51: "Zariyat", 52: "Tur", 53: "Necm", 54: "Kamer", 55: "Rahman", 56: "Vakia", 57: "Hadid", 58: "Mucadele", 59: "Hasr", 60: "Mumtehine",
61: "Saf", 62: "Cuma", 63: "Munafikun", 64: "Tegabun", 65: "Talak", 66: "Tahrim", 67: "Mulk", 68: "Kalem", 69: "Hakka", 70: "Mearic",
71: "Nuh", 72: "Cin", 73: "Muzzemmil", 74: "Muddessir", 75: "Kiyame", 76: "Insan", 77: "Murselat", 78: "Nebe", 79: "Naziat", 80: "Abese",
81: "Tekvir", 82: "Infitar", 83: "Mutaffifin", 84: "Insikak", 85: "Buruc", 86: "Tarik", 87: "Ala", 88: "Gasiye", 89: "Fecr", 90: "Beled",
91: "Sems", 92: "Leyl", 93: "Duha", 94: "Insirah", 95: "Tin", 96: "Alak", 97: "Kadr", 98: "Beyyine", 99: "Zilzal", 100: "Adiyat",
101: "Karia", 102: "Tekasur", 103: "Asr", 104: "Humeze", 105: "Fil", 106: "Kureys", 107: "Maun", 108: "Kevser", 109: "Kafirun", 110: "Nasr",
111: "Tebbet", 112: "Ihlas", 113: "Felak", 114: "Nas"
};

let currentTheme = localStorage.getItem("currentTheme") || "dark";
let highlightColor = localStorage.getItem("highlightColor") || "#1da1f2";
let fontSize = parseInt(localStorage.getItem("fontSize") || "100");
let defaultAuthor = localStorage.getItem("defaultAuthor") || "Mehmet Okuyan";
let autoScroll = localStorage.getItem("autoScroll") === "true";
let scrollSpeed = parseInt(localStorage.getItem("scrollSpeed") || "5");
let dailyVerse = localStorage.getItem("dailyVerse") === "true";
let notificationTime = localStorage.getItem("notificationTime") || "morning";
let offlineMode = localStorage.getItem("offlineMode") !== "false";
let searchHistory = localStorage.getItem("searchHistory") !== "false";

let currentSurahId = 0;
let currentVerseId = 0;

function initializeAudio() {
audioElement = document.getElementById('audio-element');
audioPlayer = document.getElementById('audio-player');

if (!audioElement) {
audioElement = document.createElement('audio');
audioElement.id = 'audio-element';
audioElement.preload = 'none';
document.body.appendChild(audioElement);
}

audioElement.addEventListener('loadedmetadata', () => {
audioDuration = audioElement.duration;
updateAudioTime();
});

audioElement.addEventListener('timeupdate', () => {
currentAudioTime = audioElement.currentTime;
updateAudioProgress();
updateAudioTime();
});

audioElement.addEventListener('ended', () => {
stopAudio();
if (currentAudioSurah < totalSurahs) {
setTimeout(() => {
playAudio(currentAudioSurah + 1);
}, 1000);
}
});

audioElement.addEventListener('error', (e) => {
console.error('Audio error:', e);
showNotification('Ses dosyası yüklenemedi', 'error');
stopAudio();
});

audioElement.addEventListener('loadstart', () => {

});

audioElement.addEventListener('canplay', () => {
hideAudioLoading();
});

setupAudioPlayerControls();
}

function setupAudioPlayerControls() {
const playPauseBtn = document.getElementById('audio-play-pause-btn');
const prevBtn = document.getElementById('audio-prev-btn');
const nextBtn = document.getElementById('audio-next-btn');
const closeBtn = document.getElementById('audio-close-btn');
const volumeBtn = document.getElementById('audio-volume-btn');
const volumeSlider = document.getElementById('volume-slider');
const progressBar = document.getElementById('audio-progress');

if (playPauseBtn) {
playPauseBtn.addEventListener('click', toggleAudioPlayPause);
}

if (prevBtn) {
prevBtn.addEventListener('click', () => {
if (currentAudioSurah > 1) {
playAudio(currentAudioSurah - 1);
}
});
}

if (nextBtn) {
nextBtn.addEventListener('click', () => {
if (currentAudioSurah < totalSurahs) {
playAudio(currentAudioSurah + 1);
}
});
}

if (closeBtn) {
closeBtn.addEventListener('click', () => {
stopAudio();
hideAudioPlayer();
});
}

if (volumeBtn) {
volumeBtn.addEventListener('click', toggleMute);
}

if (volumeSlider) {
volumeSlider.addEventListener('input', (e) => {
const volume = e.target.value / 100;
setAudioVolume(volume);
});
}

if (progressBar) {
progressBar.addEventListener('click', (e) => {
const rect = progressBar.getBoundingClientRect();
const clickX = e.clientX - rect.left;
const percentage = clickX / rect.width;
seekAudio(percentage);
});
}
}

function playAudio(surahId) {
if (isAudioPlaying && currentAudioSurah === surahId) {
toggleAudioPlayPause();
return;
}

stopAudio();

const audioUrl = `https://api.sadecekuran.com.tr/${surahId}.mp3`;
audioElement.src = audioUrl;
currentAudioSurah = surahId;

updateAudioPlayerInfo(surahId);
showAudioPlayer();

audioElement.play().then(() => {
isAudioPlaying = true;
updateAudioButtons();
updateAudioPlayerButtons();
document.body.classList.add('audio-playing');
}).catch((error) => {
console.error('Audio play error:', error);
showNotification('Ses dosyası çalınamadı', 'error');
stopAudio();
hideAudioPlayer();
});
}

function stopAudio() {
if (audioElement) {
audioElement.pause();
audioElement.currentTime = 0;
}
isAudioPlaying = false;
currentAudioSurah = null;
currentAudioTime = 0;
updateAudioButtons();
updateAudioPlayerButtons();
document.body.classList.remove('audio-playing');
}

function toggleAudioPlayPause() {
if (!audioElement || !currentAudioSurah) return;

if (isAudioPlaying) {
audioElement.pause();
isAudioPlaying = false;
} else {
audioElement.play().then(() => {
isAudioPlaying = true;
}).catch((error) => {
console.error('Audio play error:', error);
showNotification('Ses dosyası çalınamadı', 'error');
});
}

updateAudioButtons();
updateAudioPlayerButtons();
}

function setAudioVolume(volume) {
audioVolume = Math.max(0, Math.min(1, volume));
if (audioElement) {
audioElement.volume = audioVolume;
}

const volumeSlider = document.getElementById('volume-slider');
const volumeBtn = document.getElementById('audio-volume-btn');

if (volumeSlider) {
volumeSlider.value = audioVolume * 100;
}

if (volumeBtn) {
const icon = volumeBtn.querySelector('i');
if (audioVolume === 0) {
icon.className = 'fas fa-volume-mute';
} else if (audioVolume < 0.5) {
icon.className = 'fas fa-volume-down';
} else {
icon.className = 'fas fa-volume-up';
}
}
}

function toggleMute() {
if (audioVolume > 0) {
setAudioVolume(0);
} else {
setAudioVolume(1);
}
}

function seekAudio(percentage) {
if (audioElement && audioDuration) {
const newTime = audioDuration * percentage;
audioElement.currentTime = newTime;
currentAudioTime = newTime;
updateAudioProgress();
updateAudioTime();
}
}

function updateAudioProgress() {
if (audioDuration > 0) {
const percentage = (currentAudioTime / audioDuration) * 100;
const progressBar = document.getElementById('audio-progress-bar');
if (progressBar) {
progressBar.style.width = percentage + '%';
}
}
}

function updateAudioTime() {
const currentTimeEl = document.getElementById('audio-current-time');
const durationEl = document.getElementById('audio-duration');

if (currentTimeEl) {
currentTimeEl.textContent = formatTime(currentAudioTime);
}

if (durationEl) {
durationEl.textContent = formatTime(audioDuration);
}
}

function formatTime(seconds) {
if (isNaN(seconds) || seconds < 0) return '0:00';

const minutes = Math.floor(seconds / 60);
const remainingSeconds = Math.floor(seconds % 60);
return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
}

function updateAudioPlayerInfo(surahId) {
const titleEl = document.getElementById('audio-title');
const subtitleEl = document.getElementById('audio-subtitle');

if (titleEl) {
titleEl.textContent = getSurahName(surahId);
}

if (subtitleEl) {
subtitleEl.textContent = 'Sesli Kuran';
}
}

function showAudioPlayer() {
if (audioPlayer) {
audioPlayer.classList.add('active');
}
}

function hideAudioPlayer() {
if (audioPlayer) {
audioPlayer.classList.remove('active');
}
document.body.classList.remove('audio-playing');
}

function hideAudioLoading() {

}

function updateAudioButtons() {
const surahAudioBtn = document.getElementById('surah-audio-btn');
if (surahAudioBtn) {
const icon = surahAudioBtn.querySelector('i');
if (isAudioPlaying && currentAudioSurah === currentSurahId) {
icon.className = 'fas fa-pause';
surahAudioBtn.classList.add('playing');
surahAudioBtn.title = 'Duraklat';
} else {
icon.className = 'fas fa-play';
surahAudioBtn.classList.remove('playing');
surahAudioBtn.title = 'Sureyi dinle';
}
}

const verseAudioBtn = document.getElementById('verse-audio-btn');
if (verseAudioBtn) {
const icon = verseAudioBtn.querySelector('i');
if (isAudioPlaying && currentAudioSurah === currentSurahId) {
icon.className = 'fas fa-pause';
verseAudioBtn.classList.add('playing');
verseAudioBtn.title = 'Duraklat';
} else {
icon.className = 'fas fa-play';
verseAudioBtn.classList.remove('playing');
verseAudioBtn.title = 'Ayeti dinle';
}
}

document.querySelectorAll('.surah-audio-btn').forEach(btn => {
const surahId = parseInt(btn.dataset.surahId);
const icon = btn.querySelector('i');
if (isAudioPlaying && currentAudioSurah === surahId) {
icon.className = 'fas fa-pause';
btn.classList.add('playing');
btn.title = 'Duraklat';
} else {
icon.className = 'fas fa-play';
btn.classList.remove('playing');
btn.title = 'Dinle';
}
});
}

function updateAudioPlayerButtons() {
const playPauseBtn = document.getElementById('audio-play-pause-btn');
const prevBtn = document.getElementById('audio-prev-btn');
const nextBtn = document.getElementById('audio-next-btn');

if (playPauseBtn) {
const icon = playPauseBtn.querySelector('i');
if (isAudioPlaying) {
icon.className = 'fas fa-pause';
playPauseBtn.title = 'Duraklat';
} else {
icon.className = 'fas fa-play';
playPauseBtn.title = 'Oynat';
}
}

if (prevBtn) {
prevBtn.disabled = !currentAudioSurah || currentAudioSurah <= 1;
}

if (nextBtn) {
nextBtn.disabled = !currentAudioSurah || currentAudioSurah >= totalSurahs;
}
}

function getSurahName(id) {
return surahNames[id] || `Sure ${id}`;
}

function getSurahIdByName(name) {
for (const [id, surahName] of Object.entries(surahNames)) {
if (surahName.toLowerCase() === name.toLowerCase()) {
return parseInt(id);
}
}
return null;
}

function checkStorageAvailability() {
try {
const test = "test";
localStorage.setItem(test, test);
localStorage.removeItem(test);
return true;
} catch (e) {
console.warn("LocalStorage kullanılamıyor:", e);
return false;
}
}

function showLoading() {
const loadingBar = document.getElementById("loading-bar");
loadingBar.style.display = "block";
}

function hideLoading() {
const loadingBar = document.getElementById("loading-bar");
loadingBar.style.display = "none";
}

function loadAuthors(data) {
const select = document.getElementById("author-select");
select.innerHTML = '<option value="">Meal Seçin</option>';

const authorsSet = new Set();
const fragment = document.createDocumentFragment();

data.surahs.forEach(surah => {
surah.verses.forEach(verse => {
verse.translations.forEach(trans => {
authorsSet.add(trans.author);
});
});
});

const authors = Array.from(authorsSet);
originalAuthorOrder = [...authors];

if (authorOrder.length === 0) {
authorOrder = [...authors];
localStorage.setItem("authorOrder", JSON.stringify(authorOrder));
}

authors.forEach(author => {
const option = document.createElement("option");
option.value = author;
option.textContent = author;
if (author === selectedAuthor) option.selected = true;
fragment.appendChild(option);
});

select.appendChild(fragment);
}

function applyTheme(theme) {
document.body.classList.remove("day-mode", "black-mode", "eye-mode");

switch(theme) {
case "day":
document.body.classList.add("day-mode");
break;
case "black":
document.body.classList.add("black-mode");
break;
case "eye":
document.body.classList.add("eye-mode");
break;
case "dark":
default:
break;
}

currentTheme = theme;
localStorage.setItem("currentTheme", theme);
updateThemeButton();
updateThemeSelection();
}

function updateThemeButton() {
const themeToggle = document.getElementById("theme-toggle");
switch(currentTheme) {
case "day":
themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
break;
case "black":
themeToggle.innerHTML = '<i class="fas fa-circle"></i>';
break;
case "eye":
themeToggle.innerHTML = '<i class="fas fa-eye"></i>';
break;
case "dark":
default:
themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
break;
}
}

function updateThemeSelection() {
document.querySelectorAll('.theme-option').forEach(option => {
option.classList.remove('active');
if (option.dataset.theme === currentTheme) {
option.classList.add('active');
}
});
}

function cycleTheme() {
const themes = ["dark", "black", "eye", "day"];
const currentIndex = themes.indexOf(currentTheme);
const nextIndex = (currentIndex + 1) % themes.length;
applyTheme(themes[nextIndex]);
}

function setupMobileScrollDetection() {
if (window.innerWidth > 768) return;

const versesContainer = document.getElementById("verses");
if (!versesContainer) return;

versesContainer.addEventListener('scroll', handleScroll, { passive: true });
versesContainer.addEventListener('touchstart', handleScrollTouchStart, { passive: true });
versesContainer.addEventListener('touchmove', handleScrollTouchMove, { passive: true });
versesContainer.addEventListener('touchend', handleScrollTouchEnd, { passive: true });
}

function handleScroll() {
if (window.innerWidth > 768) return;

isScrolling = true;
disableVerseClicks();

if (scrollTimeout) {
clearTimeout(scrollTimeout);
}

scrollTimeout = setTimeout(() => {
isScrolling = false;
enableVerseClicks();
}, 150);
}

function handleScrollTouchStart(e) {
if (window.innerWidth > 768) return;

lastScrollY = e.touches[0].clientY;
}

function handleScrollTouchMove(e) {
if (window.innerWidth > 768) return;

const currentY = e.touches[0].clientY;
const deltaY = Math.abs(currentY - lastScrollY);

if (deltaY > scrollThreshold) {
isScrolling = true;
disableVerseClicks();
}
}

function handleScrollTouchEnd() {
if (window.innerWidth > 768) return;

setTimeout(() => {
isScrolling = false;
enableVerseClicks();
}, 100);
}

function disableVerseClicks() {
const verses = document.querySelectorAll('.verse');
verses.forEach(verse => {
verse.classList.add('scroll-disabled');
});
}

function enableVerseClicks() {
const verses = document.querySelectorAll('.verse');
verses.forEach(verse => {
verse.classList.remove('scroll-disabled');
});
}

function setupMobileLongPress() {
document.addEventListener('touchstart', handleMobileTouchStart, { passive: false });
document.addEventListener('touchend', handleMobileTouchEnd, { passive: false });
document.addEventListener('touchmove', handleMobileTouchMove, { passive: false });
}

function handleMobileTouchStart(e) {
if (window.innerWidth > 768) return;

const verse = e.target.closest('.verse');
if (!verse || verse.closest('#saved-list') || verse.classList.contains('scroll-disabled')) return;

longPressTarget = verse;
isLongPress = false;

longPressTimer = setTimeout(() => {
if (!isScrolling && longPressTarget && !longPressTarget.classList.contains('scroll-disabled')) {
isLongPress = true;
showVerseActions(verse);
if (navigator.vibrate) {
  navigator.vibrate(50);
}
}
}, 500);
}

function handleMobileTouchEnd(e) {
if (longPressTimer) {
clearTimeout(longPressTimer);
longPressTimer = null;
}

if (!isLongPress && longPressTarget && !isScrolling && !longPressTarget.classList.contains('scroll-disabled')) {
hideAllVerseActions();

const verse = longPressTarget;
if (verse && !e.target.closest('button') && !e.target.closest('a')) {
const index = parseInt(verse.dataset.index);
const surahId = parseInt(verse.dataset.surahId);
const surah = verse.dataset.surah;

if (index !== undefined && surahId && surah) {
const surahIndex = quranData.findIndex(s => s.sure === surah);
if (surahIndex !== -1) {
  const ayet = quranData[surahIndex].ayetler[index];
  displayVerseDetail(surah, ayet, index, surahId);
}
}
}
}

longPressTarget = null;
isLongPress = false;
}

function handleMobileTouchMove(e) {
if (longPressTimer) {
clearTimeout(longPressTimer);
longPressTimer = null;
}
}

function showVerseActions(verse) {
hideAllVerseActions();

const actions = verse.querySelector('.verse-actions');
if (actions) {
actions.classList.add('show');

setTimeout(() => {
actions.classList.remove('show');
}, 3000);
}
}

function hideAllVerseActions() {
document.querySelectorAll('.verse-actions.show').forEach(actions => {
actions.classList.remove('show');
});
}

function setupAuthorSorting() {
const sortBtn = document.getElementById('sort-authors-btn');
const sortBtnMobile = document.getElementById('sort-authors-btn-mobile');
const sortPanel = document.getElementById('author-sort-panel');
const closeSortPanel = document.getElementById('close-sort-panel');
const authorList = document.getElementById('author-list');
const saveSortBtn = document.getElementById('save-sort-btn');
const resetSortBtn = document.getElementById('reset-sort-btn');

if (sortBtn) {
sortBtn.addEventListener('click', (e) => {
e.stopPropagation();
showAuthorSortPanel();
});
}

if (sortBtnMobile) {
sortBtnMobile.addEventListener('click', (e) => {
e.stopPropagation();
showAuthorSortPanel();
});
}

if (closeSortPanel) {
closeSortPanel.addEventListener('click', hideAuthorSortPanel);
}

if (sortPanel) {
sortPanel.addEventListener('click', (e) => {
if (e.target === sortPanel) {
hideAuthorSortPanel();
}
});
}

if (saveSortBtn) {
saveSortBtn.addEventListener('click', saveAuthorOrder);
}

if (resetSortBtn) {
resetSortBtn.addEventListener('click', resetAuthorOrder);
}

setupDragAndDrop();
}

function showAuthorSortPanel() {
const sortPanel = document.getElementById('author-sort-panel');
const authorList = document.getElementById('author-list');

populateAuthorList();

sortPanel.style.display = 'flex';
document.body.style.overflow = 'hidden';
}

function hideAuthorSortPanel() {
const sortPanel = document.getElementById('author-sort-panel');
sortPanel.style.display = 'none';
document.body.style.overflow = '';
}

function populateAuthorList() {
const authorList = document.getElementById('author-list');
authorList.innerHTML = '';

const currentOrder = [...authorOrder];

currentOrder.forEach((author, index) => {
const authorItem = document.createElement('div');
authorItem.className = 'author-item';
authorItem.draggable = true;
authorItem.dataset.author = author;
authorItem.dataset.index = index;

authorItem.innerHTML = `
<span class="author-name">${author}</span>
<i class="fas fa-grip-vertical drag-handle"></i>
`;

authorList.appendChild(authorItem);
});
}

function setupDragAndDrop() {
let draggedElement = null;
let draggedIndex = null;

document.addEventListener('dragstart', (e) => {
if (e.target.classList.contains('author-item')) {
draggedElement = e.target;
draggedIndex = parseInt(e.target.dataset.index);
e.target.classList.add('dragging');
e.dataTransfer.effectAllowed = 'move';
}
});

document.addEventListener('dragend', (e) => {
if (e.target.classList.contains('author-item')) {
e.target.classList.remove('dragging');
draggedElement = null;
draggedIndex = null;
}
});

document.addEventListener('dragover', (e) => {
e.preventDefault();
const authorList = document.getElementById('author-list');
if (authorList && authorList.contains(e.target)) {
e.dataTransfer.dropEffect = 'move';
}
});

document.addEventListener('drop', (e) => {
e.preventDefault();
const targetItem = e.target.closest('.author-item');
const authorList = document.getElementById('author-list');

if (targetItem && draggedElement && authorList.contains(targetItem)) {
const targetIndex = parseInt(targetItem.dataset.index);

if (draggedIndex !== targetIndex) {
const draggedAuthor = authorOrder[draggedIndex];
authorOrder.splice(draggedIndex, 1);
authorOrder.splice(targetIndex, 0, draggedAuthor);

populateAuthorList();
}
}
});
}

function saveAuthorOrder() {
localStorage.setItem("authorOrder", JSON.stringify(authorOrder));
showNotification("Yazar sıralaması kaydedildi!", "success");
hideAuthorSortPanel();

const verseDetailPanel = document.getElementById('verse-detail-panel');
if (verseDetailPanel.classList.contains('active')) {
refreshOtherTranslations();
}
}

function resetAuthorOrder() {
authorOrder = [...originalAuthorOrder];
populateAuthorList();
showNotification("Sıralama sıfırlandı", "info");
}

function refreshOtherTranslations() {
const verseDetailPanel = document.getElementById('verse-detail-panel');
if (verseDetailPanel.classList.contains('active')) {
const title = document.getElementById('verse-detail-title').textContent;
const match = title.match(/(.+) - Ayet (\d+)/);
if (match) {
const sureName = match[1];
const verseId = parseInt(match[2]);
const surahIndex = quranData.findIndex(s => s.sure === sureName);
if (surahIndex !== -1) {
const verseIndex = verseId - 1;
const surahId = quranData[surahIndex].id;
const ayet = quranData[surahIndex].ayetler[verseIndex];
displayVerseDetail(sureName, ayet, verseIndex, surahId);
}
}
}
}

async function loadQuranData(author) {
const cacheKey = `quranData_${author}`;
const cachedData = localStorage.getItem(cacheKey);
const cacheExpiry = 86400000;

showLoading();

if(cachedData && checkStorageAvailability()) {
try {
const parsedCache = JSON.parse(cachedData);
const now = Date.now();

if (parsedCache.timestamp && (now - parsedCache.timestamp < cacheExpiry)) {
quranData = parsedCache.data;
displaySurahs(quranData);
dataLoaded = true;
hideLoading();

setTimeout(() => {
checkUrlHash();
}, 100);
return;
}
} catch (e) {
console.warn("Önbellek verisi ayrıştırılamadı:", e);
}
}

try {
const response = await fetch("kuran_mealleri.json");
if (!response.ok) {
throw new Error(`JSON dosyası yüklenemedi: ${response.status}`);
}
jsonData = await response.json();

quranData = jsonData.surahs.map(surah => ({
sure: getSurahName(surah.id),
ayetler: surah.verses.map(verse => {
const translation = verse.translations.find(t => t.author === author);
return translation ? `${verse.verse_id}. ${translation.text}` : `${verse.verse_id}. Çeviri bulunamadı`;
}),
id: surah.id
}));

displaySurahs(quranData);
dataLoaded = true;

setTimeout(() => {
checkUrlHash();
}, 100);

if (checkStorageAvailability()) {
try {
localStorage.setItem(
cacheKey,
JSON.stringify({
  data: quranData,
  timestamp: Date.now()
})
);
} catch (storageError) {
console.warn("localStorage'a yazma sırasında hata oluştu:", storageError);
try {
for (let i = 0; i < localStorage.length; i++) {
  const key = localStorage.key(i);
  if (key && key.startsWith('quranData_') && key !== cacheKey) {
      localStorage.removeItem(key);
  }
}
localStorage.setItem(
  cacheKey,
  JSON.stringify({
      data: quranData,
      timestamp: Date.now()
  })
);
} catch (e) {
console.warn("Önbellek temizleme başarısız:", e);
}
}
}
} catch (error) {
console.error("JSON yüklenirken hata:", error);
showNotification("Kuran mealleri yüklenirken bir hata oluştu: " + error.message, "error");
} finally {
hideLoading();
}
}

async function loadAllSurahsData() {
const cacheKey = 'allSurahsData';
const cachedData = localStorage.getItem(cacheKey);
const cacheExpiry = 604800000;

if (cachedData && checkStorageAvailability()) {
try {
const parsedCache = JSON.parse(cachedData);
const now = Date.now();

if (parsedCache.timestamp && (now - parsedCache.timestamp < cacheExpiry)) {
allSurahsData = parsedCache.data;
return allSurahsData;
}
} catch (e) {
console.warn("Önbellek verisi ayrıştırılamadı:", e);
}
}

try {
showLoading();
const response = await fetch("all_surahs_data.json");
if (!response.ok) {
throw new Error(`JSON dosyası yüklenemedi: ${response.status}`);
}

allSurahsData = await response.json();

if (checkStorageAvailability()) {
try {
localStorage.setItem(
cacheKey,
JSON.stringify({
  data: allSurahsData,
  timestamp: Date.now()
})
);
} catch (storageError) {
console.warn("localStorage'a yazma sırasında hata oluştu:", storageError);
}
}

return allSurahsData;
} catch (error) {
console.error("all_surahs_data.json yüklenirken hata:", error);
showNotification("Detaylı veri yüklenemedi. Temel özellikler çalışmaya devam edecek.", "error");
return null;
} finally {
hideLoading();
}
}

function displaySurahs(data) {
const surahsDiv = document.getElementById("surahs");
surahsDiv.innerHTML = "";

if (data.length === 0) {
surahsDiv.innerHTML = "<p>Veri bulunamadı.</p>";
return;
}

const fragment = document.createDocumentFragment();
const batchSize = 20;
let currentIndex = 0;

function processBatch() {
const endIndex = Math.min(currentIndex + batchSize, data.length);

for (let i = currentIndex; i < endIndex; i++) {
const sure = data[i];
const surahDiv = document.createElement("div");
surahDiv.className = "surah";

const surahLink = document.createElement("a");
surahLink.href = `#${sure.id}`;
surahLink.className = "verse-link";
surahLink.innerHTML = `<h2>${sure.sure}</h2>`;

const audioControls = document.createElement("div");
audioControls.className = "surah-audio-controls";
audioControls.innerHTML = `
<button class="audio-btn surah-audio-btn" data-surah-id="${sure.id}" title="Dinle">
<i class="fas fa-play"></i>
</button>
`;

surahDiv.appendChild(surahLink);
surahDiv.appendChild(audioControls);
surahDiv.dataset.index = i;
surahDiv.dataset.id = sure.id;

fragment.appendChild(surahDiv);
}

if (currentIndex === 0) {
surahsDiv.appendChild(fragment);
} else {
surahsDiv.appendChild(fragment.cloneNode(true));
}

currentIndex = endIndex;

if (currentIndex < data.length) {
requestAnimationFrame(processBatch);
}
}

processBatch();

surahsDiv.addEventListener("click", (e) => {
const audioBtn = e.target.closest('.surah-audio-btn');
if (audioBtn) {
e.stopPropagation();
const surahId = parseInt(audioBtn.dataset.surahId);
playAudio(surahId);
return;
}

const surahDiv = e.target.closest('.surah');
if (surahDiv && !e.target.closest('.surah-audio-controls')) {
const index = parseInt(surahDiv.dataset.index);
const sure = data[index];
displayVerses(sure.sure, sure.ayetler, sure.id);
surahsDiv.style.display = "none";
document.querySelector('.controls').style.display = "none";
document.getElementById("main-search-results").classList.remove("active");
}
});
}

function highlightText(text, searchTerm) {
if (!searchTerm) return text;
const regex = new RegExp(`(${searchTerm})`, "gi");
return text.replace(regex, '<span class="highlight">$1</span>');
}

function displayMainSearchResults(searchTerm) {
const resultsDiv = document.getElementById("main-search-results");
resultsDiv.innerHTML = "";

if (!searchTerm || searchTerm.length < 2) {
resultsDiv.classList.remove("active");
document.getElementById("surahs").style.display = "grid";
return;
}

const fragment = document.createDocumentFragment();
const numberMatch = searchTerm.match(/^(\d+)\s+(\d+)$/);
const surahVerseMatch = searchTerm.match(/^([a-zA-ZçÇğĞıİöÖşŞüÜ\s-]+)\s+(\d+)$/i);

if (numberMatch || surahVerseMatch) {
let surahId, verseId;

if (numberMatch) {
surahId = parseInt(numberMatch[1]);
verseId = parseInt(numberMatch[2]);
} else if (surahVerseMatch) {
const surahNameInput = surahVerseMatch[1].trim().toLowerCase();
verseId = parseInt(surahVerseMatch[2]);
surahId = Object.keys(surahNames).find(
(key) => surahNames[key].toLowerCase() === surahNameInput
);
}

if (surahId && verseId) {
const surahIndex = surahId - 1;
if (surahIndex >= 0 && surahIndex < quranData.length) {
const sure = quranData[surahIndex];
const ayet = sure.ayetler[verseId - 1];
if (ayet) {
const verseElement = document.createElement("div");
verseElement.className = "verse-result";

const verseLink = document.createElement("a");
verseLink.href = `#${surahId}-${verseId}`;
verseLink.className = "verse-link";
verseLink.textContent = `${sure.sure}: ${ayet}`;

verseElement.appendChild(verseLink);
verseElement.dataset.surah = sure.sure;
verseElement.dataset.verseIndex = verseId - 1;
verseElement.dataset.surahId = surahId;
fragment.appendChild(verseElement);
resultsDiv.appendChild(fragment);
resultsDiv.classList.add("active");
document.getElementById("surahs").style.display = "none";
return;
} else {
resultsDiv.innerHTML = "<p>Belirtilen ayet bulunamadı.</p>";
resultsDiv.classList.add("active");
document.getElementById("surahs").style.display = "none";
return;
}
} else {
resultsDiv.innerHTML = "<p>Belirtilen sure bulunamadı.</p>";
resultsDiv.classList.add("active");
document.getElementById("surahs").style.display = "none";
return;
}
}
}

let resultCount = 0;

quranData.forEach((sure, surahIndex) => {
if (sure.sure.toLowerCase().includes(searchTerm.toLowerCase())) {
const surahElement = document.createElement("div");
surahElement.className = "verse-result";

const surahLink = document.createElement("a");
surahLink.href = `#${sure.id}`;
surahLink.className = "verse-link";
surahLink.innerHTML = `<h2>${highlightText(sure.sure, searchTerm)}</h2>`;

surahElement.appendChild(surahLink);
surahElement.dataset.index = surahIndex;
fragment.appendChild(surahElement);
resultCount++;
}

sure.ayetler.forEach((ayet, verseIndex) => {
if (ayet.toLowerCase().includes(searchTerm.toLowerCase())) {
const verseElement = document.createElement("div");
verseElement.className = "verse-result";

const verseLink = document.createElement("a");
verseLink.href = `#${sure.id}-${verseIndex + 1}`;
verseLink.className = "verse-link";
verseLink.innerHTML = `${sure.sure}: ${highlightText(ayet, searchTerm)}`;

verseElement.appendChild(verseLink);
verseElement.dataset.surah = sure.sure;
verseElement.dataset.verseIndex = verseIndex;
verseElement.dataset.surahId = sure.id;
fragment.appendChild(verseElement);
resultCount++;
}
});
});

if (resultCount === 0) {
resultsDiv.innerHTML = "<p>Sonuç bulunamadı.</p>";
} else {
resultsDiv.appendChild(fragment);
}

resultsDiv.classList.add("active");
document.getElementById("surahs").style.display = "none";

resultsDiv.addEventListener("click", (e) => {
const verseResult = e.target.closest('.verse-result');
if (verseResult) {
if (verseResult.dataset.index) {
const index = parseInt(verseResult.dataset.index);
const sure = quranData[index];
displayVerses(sure.sure, sure.ayetler, sure.id);
resultsDiv.classList.remove("active");
document.getElementById("surahs").style.display = "none";
document.querySelector('.controls').style.display = "none";
} else {
const surah = verseResult.dataset.surah;
const verseIndex = parseInt(verseResult.dataset.verseIndex);
const surahId = parseInt(verseResult.dataset.surahId);
const surahIndex = quranData.findIndex(s => s.sure === surah);
const ayet = quranData[surahIndex].ayetler[verseIndex];
displayVerseDetail(surah, ayet, verseIndex, surahId);
resultsDiv.classList.remove("active");
document.querySelector('.controls').style.display = "none";
}
}
});
}

function displaySearchResults(searchTerm, container = "#search-results") {
const resultsDiv = document.querySelector(container);
resultsDiv.innerHTML = "";
const fragment = document.createDocumentFragment();

const numberMatch = searchTerm.match(/^(\d+)\s+(\d+)$/);
const surahVerseMatch = searchTerm.match(/^([a-zA-ZçÇğĞıİöÖşŞüÜ\s-]+)\s+(\d+)$/i);

if (numberMatch || surahVerseMatch) {
let surahId, verseId;

if (numberMatch) {
surahId = parseInt(numberMatch[1]);
verseId = parseInt(numberMatch[2]);
} else if (surahVerseMatch) {
const surahNameInput = surahVerseMatch[1].trim().toLowerCase();
verseId = parseInt(surahVerseMatch[2]);
surahId = Object.keys(surahNames).find(
(key) => surahNames[key].toLowerCase() === surahNameInput
);
}

if (surahId && verseId) {
const surahIndex = surahId - 1;
if (surahIndex >= 0 && surahIndex < quranData.length) {
const sure = quranData[surahIndex];
const ayet = sure.ayetler[verseId - 1];
if (ayet) {
const verseElement = document.createElement("div");
verseElement.className = "verse-result";

const verseLink = document.createElement("a");
verseLink.href = `#${surahId}-${verseId}`;
verseLink.className = "verse-link";
verseLink.textContent = `${sure.sure}: ${ayet}`;

verseElement.appendChild(verseLink);
verseElement.dataset.surah = sure.sure;
verseElement.dataset.verseIndex = verseId - 1;
verseElement.dataset.surahId = surahId;
fragment.appendChild(verseElement);
resultsDiv.appendChild(fragment);
return;
} else {
resultsDiv.innerHTML = "<p>Belirtilen ayet bulunamadı.</p>";
return;
}
} else {
resultsDiv.innerHTML = "<p>Belirtilen sure bulunamadı.</p>";
return;
}
}
}

let resultCount = 0;

quranData.forEach((sure, surahIndex) => {
if (sure.sure.toLowerCase().includes(searchTerm.toLowerCase())) {
const surahElement = document.createElement("div");
surahElement.className = "verse-result";

const surahLink = document.createElement("a");
surahLink.href = `#${sure.id}`;
surahLink.className = "verse-link";
surahLink.innerHTML = `<h2>${highlightText(sure.sure, searchTerm)}</h2>`;

surahElement.appendChild(surahLink);
surahElement.dataset.index = surahIndex;
fragment.appendChild(surahElement);
resultCount++;
}

sure.ayetler.forEach((ayet, verseIndex) => {
if (ayet.toLowerCase().includes(searchTerm.toLowerCase())) {
const verseElement = document.createElement("div");
verseElement.className = "verse-result";

const verseLink = document.createElement("a");
verseLink.href = `#${sure.id}-${verseIndex + 1}`;
verseLink.className = "verse-link";
verseLink.innerHTML = `${sure.sure}: ${highlightText(ayet, searchTerm)}`;

verseElement.appendChild(verseLink);
verseElement.dataset.surah = sure.sure;
verseElement.dataset.verseIndex = verseIndex;
verseElement.dataset.surahId = sure.id;
fragment.appendChild(verseElement);
resultCount++;
}
});
});

if (resultCount === 0) {
resultsDiv.innerHTML = "<p>Sonuç bulunamadı.</p>";
} else {
resultsDiv.appendChild(fragment);
}

resultsDiv.addEventListener("click", (e) => {
const verseResult = e.target.closest('.verse-result');
if (verseResult) {
if (verseResult.dataset.index) {
const index = parseInt(verseResult.dataset.index);
const sure = quranData[index];
displayVerses(sure.sure, sure.ayetler, sure.id);
document.getElementById("search-page").classList.remove("active");
document.getElementById("surahs").style.display = "none";
document.querySelector('.controls').style.display = "none";
} else {
const surah = verseResult.dataset.surah;
const verseIndex = parseInt(verseResult.dataset.verseIndex);
const surahId = parseInt(verseResult.dataset.surahId);
const surahIndex = quranData.findIndex(s => s.sure === surah);
const ayet = quranData[surahIndex].ayetler[verseIndex];
displayVerseDetail(surah, ayet, verseIndex, surahId);
document.getElementById("search-page").classList.remove("active");
document.querySelector('.controls').style.display = "none";
}
}
});
}

function formatVerseNumber(verseText, surahId, verseId) {
const verseMatch = verseText.match(/^(\d+\.)\s(.+)$/);

if (verseMatch) {
const verseNumber = verseMatch[1].replace('.', '');
const verseContent = verseMatch[2];

const verseLink = `<a href="#${surahId}-${verseNumber}" class="verse-link">${verseNumber}</a>`;

switch(verseNumberStyle) {
case 'bg':
return `<span class="verse-number-bg">${verseLink}</span> ${verseContent}`;
case 'bold':
return `<span style="color: var(--highlight-dark); font-weight: bold; margin-right: 5px;">${verseLink}.</span> ${verseContent}`;
case 'underline':
return `<span style="color: var(--highlight-dark); font-weight: bold; border-bottom: 2px solid var(--highlight-dark); padding-bottom: 2px; margin-right: 5px;">${verseLink}.</span> ${verseContent}`;
default:
return `${verseLink}. ${verseContent}`;
}
}

return verseText;
}

function displayVerses(sureName, ayetler, surahId) {
const panel = document.getElementById("verse-panel");
const panelTitle = document.getElementById("panel-title");
const versesDiv = document.getElementById("verses");
const savedVerses = JSON.parse(localStorage.getItem("savedVerses") || "[]");

window.location.hash = `${surahId}`;
currentSurahId = surahId;
currentVerseId = 0;

panelTitle.textContent = sureName;
versesDiv.innerHTML = "";

updateAudioButtons();

const sortedAyetler = [...ayetler].sort((a, b) => {
const aNumMatch = a.match(/^(\d+)\./);
const bNumMatch = b.match(/^(\d+)\./);

if (!aNumMatch || !bNumMatch) return 0;

const aNum = parseInt(aNumMatch[1]);
const bNum = parseInt(bNumMatch[1]);

return aNum - bNum;
});

const fragment = document.createDocumentFragment();
const batchSize = 30;
let currentIndex = 0;

function processBatch() {
const endIndex = Math.min(currentIndex + batchSize, sortedAyetler.length);

for (let i = currentIndex; i < endIndex; i++) {
const ayet = sortedAyetler[i];
const isSaved = savedVerses.some((s) => s.surah === sureName && s.verse === ayet);
const verseElement = document.createElement("p");
verseElement.className = "verse";
verseElement.dataset.verse = ayet;
verseElement.dataset.surah = sureName;
verseElement.dataset.index = i;
verseElement.dataset.surahId = surahId;

const verseNumber = ayet.match(/^(\d+)\./);
const verseId = verseNumber ? verseNumber[1] : (i + 1);

const formattedVerse = formatVerseNumber(ayet, surahId, verseId);

verseElement.innerHTML = `
<span>${formattedVerse}</span>
<span class="verse-actions">
<button class="save-btn ${isSaved ? "active" : ""}" data-verse="${ayet}" data-surah="${sureName}"><i class="fas fa-bookmark"></i></button>
<button class="share-btn" data-verse="${ayet}" data-surah="${sureName}" data-surah-id="${surahId}" data-verse-id="${verseId}"><i class="fas fa-share-alt"></i></button>
<button class="copy-url-btn" data-surah-id="${surahId}" data-verse-id="${verseId}" title="URL'yi kopyala"><i class="fas fa-link"></i></button>
</span>
`;

fragment.appendChild(verseElement);
}

if (currentIndex === 0) {
versesDiv.appendChild(fragment);
} else {
versesDiv.appendChild(fragment.cloneNode(true));
}

currentIndex = endIndex;

if (currentIndex < sortedAyetler.length) {
requestAnimationFrame(processBatch);
}
}

processBatch();

panel.classList.add("active");

versesDiv.addEventListener("click", (e) => {
const saveBtn = e.target.closest('.save-btn');
const shareBtn = e.target.closest('.share-btn');
const copyUrlBtn = e.target.closest('.copy-url-btn');
const verse = e.target.closest('.verse');

if (saveBtn) {
e.stopPropagation();
const verse = saveBtn.dataset.verse;
const surah = saveBtn.dataset.surah;
toggleSavedVerse(surah, verse, saveBtn);
} else if (shareBtn) {
e.stopPropagation();
const verse = shareBtn.dataset.verse;
const surah = shareBtn.dataset.surah;
const surahId = shareBtn.dataset.surahId;
const verseId = shareBtn.dataset.verseId;
shareVerse(surah, verse, surahId, verseId);
} else if (copyUrlBtn) {
e.stopPropagation();
const surahId = copyUrlBtn.dataset.surahId;
const verseId = copyUrlBtn.dataset.verseId;
copyVerseUrl(surahId, verseId);
} else if (verse && !e.target.closest('button') && !e.target.closest('a')) {
if (window.innerWidth > 768 || (!isScrolling && !verse.classList.contains('scroll-disabled') && !verse.querySelector('.verse-actions.show'))) {
e.stopPropagation();
const index = parseInt(verse.dataset.index);
const surahId = parseInt(verse.dataset.surahId);
displayVerseDetail(sureName, sortedAyetler[index], index, surahId);
}
}
});

setupMobileScrollDetection();
}

async function displayVerseDetail(sureName, selectedVerse, verseIndex, surahId) {
const panel = document.getElementById("verse-detail-panel");
const title = document.getElementById("verse-detail-title");
const selectedTranslation = document.getElementById("selected-translation");
const otherTranslations = document.getElementById("other-translations");
const otherTranslationsMobile = document.getElementById("other-translations-mobile");
const surahIndex = jsonData.surahs.findIndex(s => getSurahName(s.id) === sureName);
const verseData = jsonData.surahs[surahIndex].verses[verseIndex];
const allTranslations = verseData.translations;

currentSurahIndex = surahIndex;
currentVerseIndex = verseIndex;

isInVerseDetailPanel = true;

window.location.hash = `${surahId}-${verseData.verse_id}`;
currentSurahId = surahId;
currentVerseId = verseData.verse_id;

// Store current verse details for save/share buttons
currentDetailVerse = {
  surah: sureName,
  verse: selectedVerse,
  surahId: surahId,
  verseId: verseData.verse_id
};

title.textContent = `${sureName} - Ayet ${verseData.verse_id}`;

const verseContent = selectedVerse.replace(/^\d+\.\s+/, '');
selectedTranslation.innerHTML = verseContent;

updateAudioButtons();

// Update save button state
const saveBtn = document.getElementById('verse-detail-save-btn');
const savedVerses = JSON.parse(localStorage.getItem("savedVerses") || "[]");
const isSaved = savedVerses.some((s) => s.surah === sureName && s.verse === selectedVerse);
if (saveBtn) {
  if (isSaved) {
    saveBtn.classList.add('active');
    saveBtn.innerHTML = '<i class="fas fa-bookmark"></i> Kaydedildi';
  } else {
    saveBtn.classList.remove('active');
    saveBtn.innerHTML = '<i class="fas fa-bookmark"></i> Kaydet';
  }
}

const sortedTranslations = allTranslations
.filter(t => t.author !== selectedAuthor)
.sort((a, b) => {
const aIndex = authorOrder.indexOf(a.author);
const bIndex = authorOrder.indexOf(b.author);

if (aIndex === -1 && bIndex === -1) return 0;
if (aIndex === -1) return 1;
if (bIndex === -1) return -1;

return aIndex - bIndex;
});

otherTranslations.innerHTML = "";
if (otherTranslationsMobile) {
otherTranslationsMobile.innerHTML = "";
}

sortedTranslations.forEach((t, index) => {
const textWithoutNumber = t.text.replace(/^\d+\.\s+/, '');

const translationItem = document.createElement("div");
translationItem.className = "translation-item";

const floatingLabel = document.createElement("div");
floatingLabel.className = "floating-label";
floatingLabel.textContent = t.author;

const translationText = document.createElement("div");
translationText.className = "translation-text";
translationText.textContent = textWithoutNumber;

translationItem.appendChild(floatingLabel);
translationItem.appendChild(translationText);
otherTranslations.appendChild(translationItem);

if (otherTranslationsMobile) {
const mobileTranslationItem = translationItem.cloneNode(true);
otherTranslationsMobile.appendChild(mobileTranslationItem);
}
});

if (allSurahsData) {
try {
const detailedSurah = allSurahsData.surahs.find(s => s.id === surahId);
if (detailedSurah) {
const detailedVerse = detailedSurah.verses.find(v => v.verse_number === verseData.verse_id);
if (detailedVerse) {
document.getElementById("arabic-text").textContent = detailedVerse.text;
document.getElementById("transcription-tr").textContent = detailedVerse.transcription_tr;

if (showWordAnalysis && detailedVerse.words) {
const wordList = document.getElementById("word-list");
const wordListMobile = document.getElementById("word-list-mobile");

wordList.innerHTML = "";
if (wordListMobile) {
  wordListMobile.innerHTML = "";
}

detailedVerse.words.forEach((word, index) => {
  const wordItem = document.createElement("div");
  wordItem.className = "word-item";
  wordItem.dataset.index = index;
  
  wordItem.innerHTML = `
      <div class="word-arabic">${word.arabic}</div>
      <div class="word-translation">${word.translation_tr}</div>
  `;
  
  wordList.appendChild(wordItem);
  
  if (wordListMobile) {
      const mobileWordItem = wordItem.cloneNode(true);
      wordListMobile.appendChild(mobileWordItem);
  }
});

wordList.addEventListener("click", (e) => {
  handleWordClick(e, detailedVerse, surahId, verseData.verse_id, "word-detail");
});

if (wordListMobile) {
  wordListMobile.addEventListener("click", (e) => {
      handleWordClick(e, detailedVerse, surahId, verseData.verse_id, "word-detail-mobile");
  });
}
}
}
}
} catch (error) {
console.error("Detaylı ayet verisi yüklenirken hata:", error);
}
}

panel.classList.add("active");
document.getElementById("verse-panel").classList.remove("active");
document.getElementById("surahs").style.display = "none";
document.getElementById("saved-verses").style.display = "none";
document.getElementById("podcasts").style.display = "none";
document.getElementById("settings").style.display = "none";

const prevBtn = document.getElementById("prev-verse-btn");
const nextBtn = document.getElementById("next-verse-btn");

const oldPrevClick = prevBtn.onclick;
const oldNextClick = nextBtn.onclick;

if (oldPrevClick) prevBtn.removeEventListener("click", oldPrevClick);
if (oldNextClick) nextBtn.removeEventListener("click", oldNextClick);

prevBtn.onclick = () => navigateVerse(currentSurahIndex, currentVerseIndex, -1);
nextBtn.onclick = () => navigateVerse(currentSurahIndex, currentVerseIndex, 1);

setupTabEvents();
setupSwipeEvents();
}

function handleWordClick(e, detailedVerse, surahId, verseId, wordDetailId) {
const wordItem = e.target.closest('.word-item');
if (wordItem) {
const index = parseInt(wordItem.dataset.index);
const word = detailedVerse.words[index];

const wordDetail = document.getElementById(wordDetailId);
wordDetail.innerHTML = `
<div class="word-detail-row">
<div class="word-detail-label">Arapça:</div>
<div class="word-detail-value">${word.arabic}</div>
</div>
<div class="word-detail-row">
<div class="word-detail-label">Türkçe:</div>
<div class="word-detail-value">${word.translation_tr}</div>
</div>
<div class="word-detail-row">
<div class="word-detail-label">İngilizce:</div>
<div class="word-detail-value">${word.translation_en}</div>
</div>
<div class="word-detail-row">
<div class="word-detail-label">Türkçe Okunuş:</div>
<div class="word-detail-value">${word.transcription_tr}</div>
</div>
<div class="word-detail-row">
<div class="word-detail-label">İngilizce Okunuş:</div>
<div class="word-detail-value">${word.transcription_en}</div>
</div>
`;

if (word.root) {
wordDetail.innerHTML += `
<div class="root-info">
<div class="word-detail-row">
<div class="word-detail-label">Kök (Latin):</div>
<div class="word-detail-value">${word.root.latin}</div>
</div>
<div class="word-detail-row">
<div class="word-detail-label">Kök (Arapça):</div>
<div class="word-detail-value">${word.root.arabic}</div>
</div>
<div class="word-detail-row">
<div class="word-detail-label">Kök Anlamı:</div>
<div class="word-detail-value">${word.root.meaning || 'Belirtilmemiş'}</div>
</div>
</div>
`;
}

if (allSurahsData) {
wordDetail.innerHTML += `
<div class="other-occurrences">
<h4 class="occurrences-title">Bu Kelimenin Geçtiği Diğer Ayetler</h4>
<div id="word-occurrences-${wordDetailId}" class="word-occurrences">
<div class="loading-occurrences">Aranıyor...</div>
</div>
</div>
`;

setTimeout(() => {
findWordOccurrences(word.arabic, surahId, verseId, `word-occurrences-${wordDetailId}`);
}, 100);
}

wordDetail.classList.add("active");
}
}

function findWordOccurrences(wordArabic, currentSurahId, currentVerseId, containerId) {
const occurrencesDiv = document.getElementById(containerId);
if (!occurrencesDiv) return;

const occurrences = [];
let totalFound = 0;

allSurahsData.surahs.forEach(surah => {
surah.verses.forEach(verse => {
if (surah.id === currentSurahId && verse.verse_number === currentVerseId) {
return;
}

if (verse.text && verse.text.includes(wordArabic)) {
occurrences.push({
surahId: surah.id,
surahName: getSurahName(surah.id),
verseId: verse.verse_number,
text: verse.text
});
totalFound++;

if (totalFound >= 10) {
return;
}
}
});

if (totalFound >= 10) {
return;
}
});

if (occurrences.length > 0) {
let html = '';
occurrences.forEach(occurrence => {
html += `
<div class="occurrence-item">
<a href="#${occurrence.surahId}-${occurrence.verseId}" class="occurrence-link">
${occurrence.surahName} ${occurrence.verseId}
</a>
</div>
`;
});

if (totalFound >= 10) {
html += `<div class="more-occurrences">ve daha fazla...</div>`;
}

occurrencesDiv.innerHTML = html;
} else {
occurrencesDiv.innerHTML = `<div class="no-occurrences">Bu kelime başka ayette bulunamadı.</div>`;
}
}

function setupTabEvents() {
document.querySelectorAll('.tab-button').forEach(button => {
button.addEventListener('click', () => {
document.querySelectorAll('.tab-button').forEach(btn => {
btn.classList.remove('active');
});
button.classList.add('active');

const tabId = button.getAttribute('data-tab');
document.querySelectorAll('.tab-content').forEach(content => {
content.classList.remove('active');
});
document.getElementById(`${tabId}-tab`).classList.add('active');
});
});
}

function setupSwipeEvents() {
const verseDetailPanel = document.getElementById("verse-detail-panel");
if (!verseDetailPanel) return;

verseDetailPanel.addEventListener('touchstart', handleTouchStart, { passive: true });
verseDetailPanel.addEventListener('touchmove', handleTouchMove, { passive: true });
verseDetailPanel.addEventListener('touchend', handleTouchEnd, { passive: true });
}

function handleTouchStart(e) {
if (window.innerWidth > 768) return;
if (!isInVerseDetailPanel) return;

touchStartX = e.touches[0].clientX;
touchStartY = e.touches[0].clientY;
isSwipeDetected = false;
}

function handleTouchMove(e) {
if (window.innerWidth > 768) return;
if (!isInVerseDetailPanel) return;
if (!touchStartX || !touchStartY) return;

touchEndX = e.touches[0].clientX;
touchEndY = e.touches[0].clientY;

const deltaX = touchEndX - touchStartX;
const deltaY = touchEndY - touchStartY;

if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
const swipeLeftIndicator = document.getElementById('swipe-left');
const swipeRightIndicator = document.getElementById('swipe-right');

if (deltaX > 0) {
swipeLeftIndicator.classList.add('show');
swipeRightIndicator.classList.remove('show');
} else {
swipeRightIndicator.classList.add('show');
swipeLeftIndicator.classList.remove('show');
}

isSwipeDetected = true;
}
}

function handleTouchEnd(e) {
if (window.innerWidth > 768) return;
if (!isInVerseDetailPanel) return;
if (!touchStartX || !touchStartY) return;

const swipeLeftIndicator = document.getElementById('swipe-left');
const swipeRightIndicator = document.getElementById('swipe-right');

setTimeout(() => {
swipeLeftIndicator.classList.remove('show');
swipeRightIndicator.classList.remove('show');
}, 200);

if (isSwipeDetected) {
const deltaX = touchEndX - touchStartX;
const deltaY = touchEndY - touchStartY;

if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 100) {
if (deltaX > 0) {
navigateVerse(currentSurahIndex, currentVerseIndex, -1);
} else {
navigateVerse(currentSurahIndex, currentVerseIndex, 1);
}
}
}

touchStartX = 0;
touchStartY = 0;
touchEndX = 0;
touchEndY = 0;
isSwipeDetected = false;
}

function navigateVerse(surahIndex, verseIndex, direction) {
let newSurahIndex = surahIndex;
let newVerseIndex = verseIndex + direction;

if (newVerseIndex < 0) {
newSurahIndex--;
if (newSurahIndex < 0) newSurahIndex = jsonData.surahs.length - 1;
newVerseIndex = jsonData.surahs[newSurahIndex].verses.length - 1;
} else if (newVerseIndex >= jsonData.surahs[surahIndex].verses.length) {
newSurahIndex++;
if (newSurahIndex >= jsonData.surahs.length) newSurahIndex = 0;
newVerseIndex = 0;
}

const newSureName = getSurahName(jsonData.surahs[newSurahIndex].id);
const newVerse = quranData[newSurahIndex].ayetler[newVerseIndex];
const newSurahId = jsonData.surahs[newSurahIndex].id;

requestAnimationFrame(() => {
displayVerseDetail(newSureName, newVerse, newVerseIndex, newSurahId);
});
}

// SAVED VERSES FUNCTIONS - COMPLETELY REWRITTEN
function toggleSavedVerse(surah, verse, button) {
let savedVerses = JSON.parse(localStorage.getItem("savedVerses") || "[]");
const existingIndex = savedVerses.findIndex((s) => s.surah === surah && s.verse === verse);

if (existingIndex !== -1) {
// Remove from saved
savedVerses.splice(existingIndex, 1);
localStorage.setItem("savedVerses", JSON.stringify(savedVerses));
button.classList.remove("active");
showNotification("Kaydedilenlerden kaldırıldı", "info");
} else {
// Add to saved - show note modal
const verseMatch = verse.match(/^(\d+)\./);
const verseId = verseMatch ? parseInt(verseMatch[1]) : 1;
const surahId = getSurahIdByName(surah) || 
quranData.find(s => s.sure === surah)?.id || 1;

currentEditingVerse = {
surah,
verse,
surahId,
verseId,
button,
isNew: true
};

showNoteModal(verse, `${surah} - Ayet ${verseId}`, "");
}

// Update all save buttons for the same verse
document.querySelectorAll(`.save-btn[data-verse="${verse}"][data-surah="${surah}"]`).forEach(btn => {
if (existingIndex !== -1) {
btn.classList.remove("active");
} else if (!currentEditingVerse) {
btn.classList.add("active");
}
});

// Update verse detail save button if we're on that verse
if (currentDetailVerse && currentDetailVerse.surah === surah && currentDetailVerse.verse === verse) {
const detailSaveBtn = document.getElementById('verse-detail-save-btn');
if (detailSaveBtn) {
  if (existingIndex !== -1) {
    detailSaveBtn.classList.remove('active');
    detailSaveBtn.innerHTML = '<i class="fas fa-bookmark"></i> Kaydet';
  } else if (!currentEditingVerse) {
    detailSaveBtn.classList.add('active');
    detailSaveBtn.innerHTML = '<i class="fas fa-bookmark"></i> Kaydedildi';
  }
}
}

if (document.getElementById("saved-verses").style.display === "block") {
displaySavedVerses();
}
}

function showNoteModal(verseText, verseRef, existingNote = "") {
const modal = document.getElementById("note-modal");
const verseTextEl = document.getElementById("note-verse-text");
const verseRefEl = document.getElementById("note-verse-ref");
const textarea = document.getElementById("note-textarea");

verseTextEl.textContent = verseText.replace(/^\d+\.\s+/, '');
verseRefEl.textContent = verseRef;
textarea.value = existingNote;

modal.style.display = "flex";
document.body.style.overflow = "hidden";
textarea.focus();
}

function hideNoteModal() {
const modal = document.getElementById("note-modal");
modal.style.display = "none";
document.body.style.overflow = "";
currentEditingVerse = null;
}

function saveVerseWithNote() {
if (!currentEditingVerse) return;

const textarea = document.getElementById("note-textarea");
const note = textarea.value.trim();

let savedVerses = JSON.parse(localStorage.getItem("savedVerses") || "[]");

if (currentEditingVerse.isNew) {
// Add new saved verse
const newSavedVerse = {
surah: currentEditingVerse.surah,
verse: currentEditingVerse.verse,
surahId: currentEditingVerse.surahId,
verseId: currentEditingVerse.verseId,
note: note,
dateAdded: new Date().toISOString()
};

savedVerses.push(newSavedVerse);
currentEditingVerse.button.classList.add("active");
showNotification("Ayet kaydedildi!", "success");
} else {
// Update existing note
const existingIndex = savedVerses.findIndex(s => 
s.surah === currentEditingVerse.surah && 
s.verse === currentEditingVerse.verse
);

if (existingIndex !== -1) {
savedVerses[existingIndex].note = note;
savedVerses[existingIndex].dateModified = new Date().toISOString();
showNotification("Not güncellendi!", "success");
}
}

localStorage.setItem("savedVerses", JSON.stringify(savedVerses));
hideNoteModal();

// Update all save buttons for the same verse
document.querySelectorAll(`.save-btn[data-verse="${currentEditingVerse.verse}"][data-surah="${currentEditingVerse.surah}"]`).forEach(btn => {
btn.classList.add("active");
});

// Update verse detail save button if we're on that verse
if (currentDetailVerse && currentDetailVerse.surah === currentEditingVerse.surah && currentDetailVerse.verse === currentEditingVerse.verse) {
const detailSaveBtn = document.getElementById('verse-detail-save-btn');
if (detailSaveBtn) {
  detailSaveBtn.classList.add('active');
  detailSaveBtn.innerHTML = '<i class="fas fa-bookmark"></i> Kaydedildi';
}
}

if (document.getElementById("saved-verses").style.display === "block") {
displaySavedVerses();
}
}

function editSavedVerseNote(surah, verse) {
const savedVerses = JSON.parse(localStorage.getItem("savedVerses") || "[]");
const savedVerse = savedVerses.find(s => s.surah === surah && s.verse === verse);

if (savedVerse) {
currentEditingVerse = {
surah: savedVerse.surah,
verse: savedVerse.verse,
surahId: savedVerse.surahId,
verseId: savedVerse.verseId,
isNew: false
};

showNoteModal(
savedVerse.verse, 
`${savedVerse.surah} - Ayet ${savedVerse.verseId}`, 
savedVerse.note || ""
);
}
}

function deleteSavedVerse(surah, verse) {
if (confirm("Bu ayeti kaydedilenlerden kaldırmak istediğinize emin misiniz?")) {
let savedVerses = JSON.parse(localStorage.getItem("savedVerses") || "[]");
savedVerses = savedVerses.filter(s => !(s.surah === surah && s.verse === verse));
localStorage.setItem("savedVerses", JSON.stringify(savedVerses));

// Update all save buttons for the same verse
document.querySelectorAll(`.save-btn[data-verse="${verse}"][data-surah="${surah}"]`).forEach(btn => {
btn.classList.remove("active");
});

// Update verse detail save button if we're on that verse
if (currentDetailVerse && currentDetailVerse.surah === surah && currentDetailVerse.verse === verse) {
const detailSaveBtn = document.getElementById('verse-detail-save-btn');
if (detailSaveBtn) {
  detailSaveBtn.classList.remove('active');
  detailSaveBtn.innerHTML = '<i class="fas fa-bookmark"></i> Kaydet';
}
}

displaySavedVerses();
showNotification("Ayet kaydedilenlerden kaldırıldı", "info");
}
}

function displaySavedVerses() {
const savedVersesDiv = document.getElementById("saved-verses");
const savedList = document.getElementById("saved-list");
const savedVerses = JSON.parse(localStorage.getItem("savedVerses") || "[]");

savedList.innerHTML = "";

if (savedVerses.length === 0) {
savedList.innerHTML = `
<div style="text-align: center; margin: 40px 0; padding: 40px; background-color: var(--accent-dark); border-radius: 12px; border: 1px solid var(--accent-dark);">
<i class="fas fa-bookmark" style="font-size: 3rem; color: var(--highlight-dark); margin-bottom: 20px; opacity: 0.5;"></i>
<h3 style="margin-bottom: 10px; color: var(--text-dark);">Henüz kaydedilen ayet yok</h3>
<p style="color: var(--text-dark); opacity: 0.7; font-size: 0.95rem;">Beğendiğiniz ayetleri kaydetmek için ayet üzerindeki <i class="fas fa-bookmark"></i> simgesine tıklayın</p>
</div>
`;
} else {
const fragment = document.createDocumentFragment();

// Sort by date added (newest first)
savedVerses.sort((a, b) => new Date(b.dateAdded) - new Date(a.dateAdded));

savedVerses.forEach((savedVerse, index) => {
const savedVerseItem = document.createElement("div");
savedVerseItem.className = "saved-verse-item";
savedVerseItem.dataset.surah = savedVerse.surah;
savedVerseItem.dataset.verse = savedVerse.verse;
savedVerseItem.dataset.surahId = savedVerse.surahId;
savedVerseItem.dataset.verseId = savedVerse.verseId;

const formattedVerse = formatVerseNumber(savedVerse.verse, savedVerse.surahId, savedVerse.verseId);
const dateAdded = new Date(savedVerse.dateAdded).toLocaleDateString('tr-TR');

const surahEscaped = savedVerse.surah.replace(/'/g, "\\'");
const verseEscaped = savedVerse.verse.replace(/'/g, "\\'");

savedVerseItem.innerHTML = `
<div class="saved-verse-content">
<div class="saved-verse-text">${formattedVerse}</div>
<div class="saved-verse-reference">${savedVerse.surah} - Ayet ${savedVerse.verseId}</div>
${savedVerse.note ? `
<div class="saved-verse-note">
<div class="saved-verse-note-label">
<i class="fas fa-sticky-note"></i> Notum
</div>
<div class="saved-verse-note-text">${savedVerse.note}</div>
</div>
` : ''}
</div>
<div class="saved-verse-actions">
<div class="saved-verse-buttons">
<button class="saved-verse-btn edit-note" onclick="editSavedVerseNote('${surahEscaped}', '${verseEscaped}')" title="Notu düzenle">
<i class="fas fa-edit"></i> ${savedVerse.note ? 'Düzenle' : 'Not Ekle'}
</button>
<button class="saved-verse-btn copy-url" onclick="copyVerseUrl(${savedVerse.surahId}, ${savedVerse.verseId})" title="URL'yi kopyala">
<i class="fas fa-link"></i> Paylaş
</button>
<button class="saved-verse-btn delete" onclick="deleteSavedVerse('${surahEscaped}', '${verseEscaped}')" title="Sil">
<i class="fas fa-trash-alt"></i> Sil
</button>
</div>
<div class="saved-verse-date">${dateAdded}</div>
</div>
`;

fragment.appendChild(savedVerseItem);
});

savedList.appendChild(fragment);
}

// Add click event for verse items
savedList.addEventListener("click", (e) => {
const savedVerseItem = e.target.closest('.saved-verse-item');
if (savedVerseItem && !e.target.closest('button')) {
e.stopPropagation();
const surah = savedVerseItem.dataset.surah;
const verseText = savedVerseItem.dataset.verse;
const surahId = parseInt(savedVerseItem.dataset.surahId);
const verseId = parseInt(savedVerseItem.dataset.verseId);

const surahIndex = quranData.findIndex(s => s.sure === surah);
if (surahIndex === -1) return;

const verseIndex = verseId - 1;

displayVerseDetail(surah, verseText, verseIndex, surahId);
savedVersesDiv.style.display = "none";
}
});
}

function shareVerse(surah, verse, surahId, verseId) {
const url = `${window.location.origin}${window.location.pathname}#${surahId}-${verseId}`;
const text = `${surah}: ${verse} - Sadece Kuran
${url}`;

if (navigator.share) {
navigator
.share({
title: "Sadece Kuran",
text: text,
url: url
})
.catch((err) => console.log("Paylaşım hatası:", err));
} else {
navigator.clipboard.writeText(text)
.then(() => {
showNotification('Metin kopyalandı');
})
.catch(err => {
console.error('Kopyalama hatası:', err);
showNotification("Paylaşım desteklenmiyor, metni manuel kopyalayın: " + text, "error");
});
}
}

function copyVerseUrl(surahId, verseId) {
const url = `${window.location.origin}${window.location.pathname}#${surahId}-${verseId}`;

navigator.clipboard.writeText(url)
.then(() => {
showNotification('URL kopyalandı');
})
.catch(err => {
console.error('URL kopyalama hatası:', err);
showNotification("URL kopyalanamadı: " + url, "error");
});
}

function showNotification(message, type = 'success') {
const notification = document.createElement('div');
notification.style.position = 'fixed';
notification.style.bottom = '20px';
notification.style.left = '50%';
notification.style.transform = 'translateX(-50%)';
notification.style.background = type === 'success' ? 'rgba(29, 161, 242, 0.9)' : 
                  type === 'error' ? 'rgba(229, 62, 62, 0.9)' : 
                  'rgba(156, 39, 176, 0.9)';
notification.style.color = 'white';
notification.style.padding = '10px 20px';
notification.style.borderRadius = '5px';
notification.style.zIndex = '1000';
notification.style.fontSize = '0.9rem';
notification.style.maxWidth = '300px';
notification.style.textAlign = 'center';
notification.textContent = message;
document.body.appendChild(notification);

setTimeout(() => {
notification.style.opacity = '0';
notification.style.transition = 'opacity 0.5s ease';
setTimeout(() => {
if (document.body.contains(notification)) {
document.body.removeChild(notification);
}
}, 500);
}, 2000);
}

function requestNotificationPermission() {
if ('Notification' in window && Notification.permission !== 'granted') {
Notification.requestPermission().then(function(permission) {
if (permission === 'granted') {
notificationPermissionGranted = true;
showNotification("Bildirimler etkinleştirildi!", "success");
scheduleNotifications();
} else {
showNotification("Bildirim izni reddedildi", "error");
}
});
} else if (Notification.permission === 'granted') {
notificationPermissionGranted = true;
scheduleNotifications();
}
}

function scheduleNotifications() {
if (!notificationPermissionGranted || !dailyVerse) return;

if ('serviceWorker' in navigator) {
navigator.serviceWorker.ready.then(registration => {
registration.getNotifications().then(notifications => {
notifications.forEach(notification => notification.close());
});
});
}

const now = new Date();
const notificationHour = getNotificationHour();
const nextNotification = new Date(now);
nextNotification.setHours(notificationHour, 0, 0, 0);

if (nextNotification <= now) {
nextNotification.setDate(nextNotification.getDate() + 1);
}

const timeUntilNotification = nextNotification.getTime() - now.getTime();

setTimeout(() => {
sendDailyVerseNotification();
setInterval(sendDailyVerseNotification, 24 * 60 * 60 * 1000);
}, timeUntilNotification);
}

function getNotificationHour() {
switch(notificationTime) {
case 'morning': return 8;
case 'noon': return 12;
case 'evening': return 18;
case 'night': return 21;
default: return 8;
}
}

function sendDailyVerseNotification() {
if (!notificationPermissionGranted || !dailyVerse || !quranData.length) return;

const randomSurah = quranData[Math.floor(Math.random() * quranData.length)];
const randomVerse = randomSurah.ayetler[Math.floor(Math.random() * randomSurah.ayetler.length)];

const notification = new Notification('Günlük Ayet - Sadece Kuran', {
body: `${randomSurah.sure}: ${randomVerse.substring(0, 100)}...`,
icon: '/logokuran2.jpg',
badge: '/logokuran2.jpg',
tag: 'daily-verse',
requireInteraction: false
});

notification.onclick = function() {
window.focus();
const verseMatch = randomVerse.match(/^(\d+)\./);
const verseId = verseMatch ? parseInt(verseMatch[1]) : 1;
window.location.hash = `${randomSurah.id}-${verseId}`;
notification.close();
};
}

window.addEventListener('hashchange', async function() {
await checkUrlHash();
});

async function checkUrlHash() {
const hash = window.location.hash.substring(1);

if (!hash) {
isInVerseDetailPanel = false;
return;
}

if (!dataLoaded || !jsonData.surahs || jsonData.surahs.length === 0) {
setTimeout(checkUrlHash, 200);
return;
}

if (hash === 'search') {
showSearch();
isInVerseDetailPanel = false;
return;
} else if (hash === 'saved') {
showSavedVerses();
isInVerseDetailPanel = false;
return;
} else if (hash === 'settings') {
showSettings();
isInVerseDetailPanel = false;
return;
}

const surahVerseMatch = hash.match(/^(\d+)-(\d+)$/);
const surahMatch = hash.match(/^(\d+)$/);

if (!allSurahsData) {
allSurahsData = await loadAllSurahsData();
}

if (surahVerseMatch) {
const surahId = parseInt(surahVerseMatch[1]);
const verseId = parseInt(surahVerseMatch[2]);

if (currentSurahId === surahId && currentVerseId === verseId) return;

const surahIndex = surahId - 1;

if (surahIndex >= 0 && surahIndex < quranData.length) {
const sure = quranData[surahIndex];
const verseIndex = verseId - 1;

if (verseIndex >= 0 && verseIndex < sure.ayetler.length) {
const ayet = sure.ayetler[verseIndex];
displayVerseDetail(sure.sure, ayet, verseIndex, surahId);

document.getElementById("surahs").style.display = "none";
document.getElementById("saved-verses").style.display = "none";
document.getElementById("podcasts").style.display = "none";
document.getElementById("settings").style.display = "none";
document.getElementById("search-page").classList.remove("active");
document.querySelector('.controls').style.display = "none";
}
}
} else if (surahMatch) {
const surahId = parseInt(surahMatch[1]);

if (currentSurahId === surahId && currentVerseId === 0) return;

const surahIndex = surahId - 1;

if (surahIndex >= 0 && surahIndex < quranData.length) {
const sure = quranData[surahIndex];
displayVerses(sure.sure, sure.ayetler, surahId);

document.getElementById("surahs").style.display = "none";
document.getElementById("verse-detail-panel").classList.remove("active");
document.getElementById("saved-verses").style.display = "none";
document.getElementById("podcasts").style.display = "none";
document.getElementById("settings").style.display = "none";
document.getElementById("search-page").classList.remove("active");
document.querySelector('.controls').style.display = "none";
isInVerseDetailPanel = false;
}
}
}

function updateActiveTab(id) {
document.querySelectorAll('.sidebar .nav-item').forEach(item => {
item.classList.remove('active');
});
if (document.getElementById(`${id}-nav-desktop`)) {
document.getElementById(`${id}-nav-desktop`).classList.add('active');
}

document.querySelectorAll('.bottom-nav-item').forEach(item => {
item.classList.remove('active');
});
if (document.getElementById(`${id}-nav`)) {
document.getElementById(`${id}-nav`).classList.add('active');
}
}

function setupKeyboardNavigation() {
document.addEventListener('keydown', function(e) {
const verseDetailPanel = document.getElementById("verse-detail-panel");

if (!verseDetailPanel.classList.contains('active')) return;

if (e.key === 'ArrowLeft') {
e.preventDefault();
navigateVerse(currentSurahIndex, currentVerseIndex, -1);
} else if (e.key === 'ArrowRight') {
e.preventDefault();
navigateVerse(currentSurahIndex, currentVerseIndex, 1);
}
});
}

document.addEventListener("DOMContentLoaded", async () => {

try {
const response = await fetch("kuran_mealleri.json");
if (!response.ok) {
throw new Error(`JSON dosyası yüklenemedi: ${response.status}`);
}
jsonData = await response.json();
loadAuthors(jsonData);
await loadQuranData(selectedAuthor);

allSurahsData = await loadAllSurahsData();

applyTheme(currentTheme);
applySettings();
setupKeyboardNavigation();
setupMobileLongPress();
setupAuthorSorting();
initializeAudio();

if (dailyVerse) {
requestNotificationPermission();
}
} catch (error) {
console.error("Başlangıçta hata:", error);
showNotification("Uygulama başlatılırken bir hata oluştu: " + error.message, "error");
}

document.getElementById("author-select").addEventListener("change", async (e) => {
selectedAuthor = e.target.value;
if (selectedAuthor) {
await loadQuranData(selectedAuthor);
document.getElementById("surahs").style.display = "block";
document.getElementById("verse-panel").classList.remove("active");
document.getElementById("verse-detail-panel").classList.remove("active");
document.getElementById("saved-verses").style.display = "none";
document.getElementById("podcasts").style.display = "none";
document.getElementById("settings").style.display = "none";
document.querySelector('.controls').style.display = "flex";
isInVerseDetailPanel = false;
}
});

document.getElementById("close-panel").addEventListener("click", () => {
showHome();
});

document.getElementById("back-btn").addEventListener("click", () => {
const panel = document.getElementById("verse-detail-panel");
const versePanel = document.getElementById("verse-panel");
const savedVersesDiv = document.getElementById("saved-verses");

panel.classList.remove("active");
isInVerseDetailPanel = false;

if (savedVersesDiv.style.display === "block") {
savedVersesDiv.style.display = "block";
} else {
versePanel.classList.add("active");
if (currentSurahId > 0) {
window.location.hash = `${currentSurahId}`;
currentVerseId = 0;
}
}
});

document.getElementById("surah-audio-btn").addEventListener("click", () => {
if (currentSurahId) {
playAudio(currentSurahId);
}
});

document.getElementById("verse-audio-btn").addEventListener("click", () => {
if (currentSurahId) {
playAudio(currentSurahId);
}
});

// Verse detail save and share buttons
document.getElementById("verse-detail-save-btn").addEventListener("click", () => {
if (currentDetailVerse) {
const button = document.getElementById("verse-detail-save-btn");
toggleSavedVerse(currentDetailVerse.surah, currentDetailVerse.verse, button);
}
});

document.getElementById("verse-detail-share-btn").addEventListener("click", () => {
if (currentDetailVerse) {
shareVerse(currentDetailVerse.surah, currentDetailVerse.verse, currentDetailVerse.surahId, currentDetailVerse.verseId);
}
});

document.getElementById("show-saved").addEventListener("click", () => {
showSavedVerses();
});

document.getElementById("back-to-surahs").addEventListener("click", () => {
showHome();
});

document.getElementById("search-nav-desktop").addEventListener("click", () => {
showSearch();
});

document.getElementById("search-nav").addEventListener("click", () => {
showSearch();
});

document.querySelector(".search-page-back").addEventListener("click", () => {
document.getElementById("search-page").classList.remove("active");
history.pushState("", document.title, window.location.pathname);
});

document.querySelectorAll(".example-search").forEach(item => {
item.addEventListener("click", () => {
const searchTerm = item.textContent.replace(/[#\s]/g, '').trim();
document.getElementById("search-page-input").value = searchTerm;
displaySearchResults(searchTerm);
});
});

document.getElementById("saved-nav-desktop").addEventListener("click", () => {
showSavedVerses();
});

document.getElementById("saved-nav").addEventListener("click", () => {
showSavedVerses();
});

document.getElementById("meal-writers-nav-desktop").addEventListener("click", () => {
window.location.href = "mealyazarlar.html";
});

document.getElementById("podcasts-nav-desktop").addEventListener("click", () => {
showPodcasts();
});

document.getElementById("settings-nav-desktop").addEventListener("click", () => {
showSettings();
});

document.getElementById("settings-nav").addEventListener("click", () => {
showSettings();
});

document.getElementById("home-nav-desktop").addEventListener("click", () => {
showHome();
});

document.getElementById("home-nav").addEventListener("click", () => {
showHome();
});

document.getElementById("home-btn").addEventListener("click", () => {
if (window.innerWidth <= 768) {
window.location.href = "/makaleler.html";
} else {
showHome();
}
});

// Note modal event listeners
document.getElementById("close-note-modal").addEventListener("click", hideNoteModal);
document.getElementById("cancel-note-btn").addEventListener("click", hideNoteModal);
document.getElementById("save-note-btn").addEventListener("click", saveVerseWithNote);

// Close modal when clicking outside
document.getElementById("note-modal").addEventListener("click", (e) => {
if (e.target.id === "note-modal") {
hideNoteModal();
}
});

setupSettingsEventListeners();
});

function showHome() {
document.getElementById("search").value = "";

document.getElementById("surahs").style.display = "block";
document.querySelector('.controls').style.display = "flex";

document.getElementById("verse-panel").classList.remove("active");
document.getElementById("verse-detail-panel").classList.remove("active");
document.getElementById("saved-verses").style.display = "none";
document.getElementById("podcasts").style.display = "none";
document.getElementById("settings").style.display = "none";
document.getElementById("search-page").classList.remove("active");
document.getElementById("main-search-results").classList.remove("active");

updateActiveTab('home');

history.pushState("", document.title, window.location.pathname);
currentSurahId = 0;
currentVerseId = 0;
isInVerseDetailPanel = false;

displaySurahs(quranData);
}

function showSearch() {
document.getElementById("search-page").classList.add("active");
document.getElementById("search-page-input").focus();
updateActiveTab('search');
document.querySelector('.controls').style.display = "none";
window.location.hash = "search";
isInVerseDetailPanel = false;
}

function showSavedVerses() {
document.getElementById("surahs").style.display = "none";
document.getElementById("verse-panel").classList.remove("active");
document.getElementById("verse-detail-panel").classList.remove("active");
document.getElementById("saved-verses").style.display = "block";
document.getElementById("podcasts").style.display = "none";
document.getElementById("settings").style.display = "none";
displaySavedVerses();
updateActiveTab('saved');
document.querySelector('.controls').style.display = "none";
window.location.hash = "saved";
isInVerseDetailPanel = false;
}

function showPodcasts() {
document.getElementById("surahs").style.display = "none";
document.getElementById("verse-panel").classList.remove("active");
document.getElementById("verse-detail-panel").classList.remove("active");
document.getElementById("saved-verses").style.display = "none";
document.getElementById("podcasts").style.display = "block";
document.getElementById("settings").style.display = "none";
updateActiveTab('podcasts');

document.querySelector('.controls').style.display = "none";
history.pushState("", document.title, window.location.pathname);
currentSurahId = 0;
currentVerseId = 0;
isInVerseDetailPanel = false;
}

function showSettings() {
document.getElementById("surahs").style.display = "none";
document.getElementById("verse-panel").classList.remove("active");
document.getElementById("verse-detail-panel").classList.remove("active");
document.getElementById("saved-verses").style.display = "none";
document.getElementById("podcasts").style.display = "none";
document.getElementById("settings").style.display = "block";
updateActiveTab('settings');
document.querySelector('.controls').style.display = "none";
window.location.hash = "settings";
isInVerseDetailPanel = false;
}

function debounce(func, wait) {
let timeout;
return function(...args) {
clearTimeout(timeout);
timeout = setTimeout(() => func.apply(this, args), wait);
};
}

const debouncedSearch = debounce(function(e) {
const searchTerm = e.target.value.trim();
if (searchTerm === "") {
document.getElementById("main-search-results").classList.remove("active");
document.getElementById("surahs").style.display = "grid";
document.getElementById("verse-detail-panel").classList.remove("active");
isInVerseDetailPanel = false;
} else {
displayMainSearchResults(searchTerm);
}
document.getElementById("verse-panel").classList.remove("active");
}, 300);

document.getElementById("search").addEventListener("input", debouncedSearch);

const debouncedPageSearch = debounce(function(e) {
const searchTerm = e.target.value.trim();
if (searchTerm === "") {
document.getElementById("search-results").innerHTML = "<p>Arama yapmak için bir kelime yazın.</p>";
} else {
displaySearchResults(searchTerm);
}
}, 300);

document.getElementById("search-page-input").addEventListener("input", debouncedPageSearch);

function applySettings() {
applyHighlightColor(highlightColor);

updateFontSize();

if (defaultAuthor && defaultAuthor !== selectedAuthor) {
selectedAuthor = defaultAuthor;
const authorSelect = document.getElementById("author-select");
if (authorSelect.querySelector(`option[value="${defaultAuthor}"]`)) {
authorSelect.value = defaultAuthor;
loadQuranData(defaultAuthor);
}
}

document.getElementById("verse-number-style").value = verseNumberStyle;

document.getElementById("arabic-display-mode").value = arabicDisplayMode;

document.getElementById("word-analysis-toggle").checked = showWordAnalysis;

document.getElementById("daily-verse-toggle").checked = dailyVerse;
document.getElementById("notification-time").value = notificationTime;
document.getElementById("auto-scroll-toggle").checked = autoScroll;
document.getElementById("scroll-speed").value = scrollSpeed;
document.getElementById("offline-toggle").checked = offlineMode;
document.getElementById("search-history-toggle").checked = searchHistory;
}

function applyHighlightColor(color) {
document.documentElement.style.setProperty('--highlight-dark', color);
document.documentElement.style.setProperty('--highlight-light', color);
}

function updateFontSize() {
document.getElementById("font-size-value").textContent = fontSize + "%";
document.documentElement.style.setProperty('--verse-font-size', fontSize + "%");
}

function setupSettingsEventListeners() {
document.querySelectorAll('.theme-option').forEach(option => {
option.addEventListener('click', function() {
const theme = this.dataset.theme;
applyTheme(theme);
});
});

document.querySelectorAll(".color-option").forEach(option => {
option.addEventListener("click", function() {
document.querySelectorAll(".color-option").forEach(opt => opt.classList.remove("active"));
this.classList.add("active");
highlightColor = this.dataset.color;
localStorage.setItem("highlightColor", highlightColor);
applyHighlightColor(highlightColor);
});
});

document.getElementById("decrease-font").addEventListener("click", function() {
if (fontSize > 70) {
fontSize -= 10;
updateFontSize();
localStorage.setItem("fontSize", fontSize);
}
});

document.getElementById("increase-font").addEventListener("click", function() {
if (fontSize < 150) {
fontSize += 10;
updateFontSize();
localStorage.setItem("fontSize", fontSize);
}
});

document.getElementById("verse-number-style").addEventListener("change", function(e) {
verseNumberStyle = e.target.value;
localStorage.setItem("verseNumberStyle", verseNumberStyle);
showNotification("Ayet numarası stili değiştirildi");
});

document.getElementById("arabic-display-mode").addEventListener("change", function(e) {
arabicDisplayMode = e.target.value;
localStorage.setItem("arabicDisplayMode", arabicDisplayMode);
showNotification("Arapça metin görünümü değiştirildi");
});

document.getElementById("word-analysis-toggle").addEventListener("change", function(e) {
showWordAnalysis = e.target.checked;
localStorage.setItem("showWordAnalysis", showWordAnalysis);
showNotification("Kelime analizi görünümü " + (showWordAnalysis ? "etkinleştirildi" : "devre dışı bırakıldı"));
});

document.getElementById("default-author").addEventListener("change", function(e) {
defaultAuthor = e.target.value;
localStorage.setItem("defaultAuthor", defaultAuthor);
showNotification("Varsayılan meal değiştirildi: " + defaultAuthor);

if (defaultAuthor !== selectedAuthor) {
selectedAuthor = defaultAuthor;
document.getElementById("author-select").value = defaultAuthor;
loadQuranData(defaultAuthor);
}
});

document.getElementById("auto-scroll-toggle").addEventListener("change", function(e) {
autoScroll = e.target.checked;
localStorage.setItem("autoScroll", autoScroll);
});

document.getElementById("scroll-speed").addEventListener("input", function(e) {
scrollSpeed = e.target.value;
localStorage.setItem("scrollSpeed", scrollSpeed);
});

document.getElementById("daily-verse-toggle").addEventListener("change", function(e) {
dailyVerse = e.target.checked;
localStorage.setItem("dailyVerse", dailyVerse);
if (dailyVerse) {
requestNotificationPermission();
} else {
if ('serviceWorker' in navigator) {
navigator.serviceWorker.ready.then(registration => {
registration.getNotifications().then(notifications => {
notifications.forEach(notification => notification.close());
});
});
}
}
});

document.getElementById("notification-time").addEventListener("change", function(e) {
notificationTime = e.target.value;
localStorage.setItem("notificationTime", notificationTime);
if (dailyVerse && notificationPermissionGranted) {
scheduleNotifications();
}
});

document.getElementById("offline-toggle").addEventListener("change", function(e) {
offlineMode = e.target.checked;
localStorage.setItem("offlineMode", offlineMode);
});

document.getElementById("search-history-toggle").addEventListener("change", function(e) {
searchHistory = e.target.checked;
localStorage.setItem("searchHistory", searchHistory);
if (!searchHistory) {
localStorage.removeItem("searchHistoryData");
}
});

document.getElementById("clear-data-btn").addEventListener("click", function() {
if (confirm("Tüm uygulama verilerini silmek istediğinize emin misiniz? Bu işlem geri alınamaz.")) {
clearAllData();
}
});

document.getElementById("feedback-btn").addEventListener("click", function() {
window.location.href = "mailto:info@sadecekuran.com.tr?subject=Sadece Kuran Uygulama Geri Bildirimi";
});

document.getElementById("app-btn").addEventListener("click", function() {
showNotification("Mobil uygulama yakında mağazalarda!", "info");
});

document.getElementById("theme-toggle").addEventListener("click", cycleTheme);
}

function clearAllData() {
const themeValue = localStorage.getItem("currentTheme");
const highlightValue = localStorage.getItem("highlightColor");
const verseNumberStyleValue = localStorage.getItem("verseNumberStyle");
localStorage.clear();
localStorage.setItem("currentTheme", themeValue);
localStorage.setItem("highlightColor", highlightValue);
localStorage.setItem("verseNumberStyle", verseNumberStyleValue);

showNotification("Tüm veriler temizlendi");

setTimeout(() => {
window.location.reload();
}, 1500);
}
</script>
</body>
</html>